(self["webpackChunkvote_coin_demo"]=self["webpackChunkvote_coin_demo"]||[]).push([[613],{98916:function(t){"use strict";var e=Object.prototype.hasOwnProperty,r="~";function n(){}function i(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function s(t,e,n,s,o){if("function"!==typeof n)throw new TypeError("The listener must be a function");var a=new i(n,s||t,o),h=r?r+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function o(t,e){0===--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,n,i=[];if(0===this._eventsCount)return i;for(n in t=this._events)e.call(t,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},a.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,i,s,o){var a=r?r+t:t;if(!this._events[a])return!1;var h,c,l=this._events[a],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,i),!0;case 5:return l.fn.call(l.context,e,n,i,s),!0;case 6:return l.fn.call(l.context,e,n,i,s,o),!0}for(c=1,h=new Array(u-1);c<u;c++)h[c-1]=arguments[c];l.fn.apply(l.context,h)}else{var d,f=l.length;for(c=0;c<f;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),u){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,n);break;case 4:l[c].fn.call(l[c].context,e,n,i);break;default:if(!h)for(d=1,h=new Array(u-1);d<u;d++)h[d-1]=arguments[d];l[c].fn.apply(l[c].context,h)}}return!0},a.prototype.on=function(t,e,r){return s(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return s(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,n,i){var s=r?r+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||i&&!a.once||n&&a.context!==n||o(this,s);else{for(var h=0,c=[],l=a.length;h<l;h++)(a[h].fn!==e||i&&!a[h].once||n&&a[h].context!==n)&&c.push(a[h]);c.length?this._events[s]=1===c.length?c[0]:c:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&o(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a},49873:function(t,e){var r,n,i,s=function(){var t=function(t,e){var n=236,s=17,f=t,p=r[e],g=null,y=0,m=null,b=[],_={},v=function(t,e){y=4*f+17,g=function(t){for(var e=new Array(t),r=0;r<t;r+=1){e[r]=new Array(t);for(var n=0;n<t;n+=1)e[r][n]=null}return e}(y),A(0,0),A(y-7,0),A(0,y-7),x(),E(),S(t,e),f>=7&&C(t),null==m&&(m=R(f,p,b)),O(m,e)},A=function(t,e){for(var r=-1;r<=7;r+=1)if(!(t+r<=-1||y<=t+r))for(var n=-1;n<=7;n+=1)e+n<=-1||y<=e+n||(g[t+r][e+n]=0<=r&&r<=6&&(0==n||6==n)||0<=n&&n<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=n&&n<=4)},k=function(){for(var t=0,e=0,r=0;r<8;r+=1){v(!0,r);var n=i.getLostPoint(_);(0==r||t>n)&&(t=n,e=r)}return e},E=function(){for(var t=8;t<y-8;t+=1)null==g[t][6]&&(g[t][6]=t%2==0);for(var e=8;e<y-8;e+=1)null==g[6][e]&&(g[6][e]=e%2==0)},x=function(){for(var t=i.getPatternPosition(f),e=0;e<t.length;e+=1)for(var r=0;r<t.length;r+=1){var n=t[e],s=t[r];if(null==g[n][s])for(var o=-2;o<=2;o+=1)for(var a=-2;a<=2;a+=1)g[n+o][s+a]=-2==o||2==o||-2==a||2==a||0==o&&0==a}},C=function(t){for(var e=i.getBCHTypeNumber(f),r=0;r<18;r+=1){var n=!t&&1==(e>>r&1);g[Math.floor(r/3)][r%3+y-8-3]=n}for(r=0;r<18;r+=1){n=!t&&1==(e>>r&1);g[r%3+y-8-3][Math.floor(r/3)]=n}},S=function(t,e){for(var r=p<<3|e,n=i.getBCHTypeInfo(r),s=0;s<15;s+=1){var o=!t&&1==(n>>s&1);s<6?g[s][8]=o:s<8?g[s+1][8]=o:g[y-15+s][8]=o}for(s=0;s<15;s+=1){o=!t&&1==(n>>s&1);s<8?g[8][y-s-1]=o:s<9?g[8][15-s-1+1]=o:g[8][15-s-1]=o}g[y-8][8]=!t},O=function(t,e){for(var r=-1,n=y-1,s=7,o=0,a=i.getMaskFunction(e),h=y-1;h>0;h-=2){6==h&&(h-=1);while(1){for(var c=0;c<2;c+=1)if(null==g[n][h-c]){var l=!1;o<t.length&&(l=1==(t[o]>>>s&1));var u=a(n,h-c);u&&(l=!l),g[n][h-c]=l,s-=1,-1==s&&(o+=1,s=7)}if(n+=r,n<0||y<=n){n-=r,r=-r;break}}}},M=function(t,e){for(var r=0,n=0,s=0,a=new Array(e.length),h=new Array(e.length),c=0;c<e.length;c+=1){var l=e[c].dataCount,u=e[c].totalCount-l;n=Math.max(n,l),s=Math.max(s,u),a[c]=new Array(l);for(var d=0;d<a[c].length;d+=1)a[c][d]=255&t.getBuffer()[d+r];r+=l;var f=i.getErrorCorrectPolynomial(u),p=o(a[c],f.getLength()-1),g=p.mod(f);h[c]=new Array(f.getLength()-1);for(d=0;d<h[c].length;d+=1){var y=d+g.getLength()-h[c].length;h[c][d]=y>=0?g.getAt(y):0}}var w=0;for(d=0;d<e.length;d+=1)w+=e[d].totalCount;var m=new Array(w),b=0;for(d=0;d<n;d+=1)for(c=0;c<e.length;c+=1)d<a[c].length&&(m[b]=a[c][d],b+=1);for(d=0;d<s;d+=1)for(c=0;c<e.length;c+=1)d<h[c].length&&(m[b]=h[c][d],b+=1);return m},R=function(t,e,r){for(var o=a.getRSBlocks(t,e),c=h(),l=0;l<r.length;l+=1){var u=r[l];c.put(u.getMode(),4),c.put(u.getLength(),i.getLengthInBits(u.getMode(),t)),u.write(c)}var d=0;for(l=0;l<o.length;l+=1)d+=o[l].dataCount;if(c.getLengthInBits()>8*d)throw"code length overflow. ("+c.getLengthInBits()+">"+8*d+")";c.getLengthInBits()+4<=8*d&&c.put(0,4);while(c.getLengthInBits()%8!=0)c.putBit(!1);while(1){if(c.getLengthInBits()>=8*d)break;if(c.put(n,8),c.getLengthInBits()>=8*d)break;c.put(s,8)}return M(c,o)};_.addData=function(t,e){e=e||"Byte";var r=null;switch(e){case"Numeric":r=c(t);break;case"Alphanumeric":r=l(t);break;case"Byte":r=u(t);break;case"Kanji":r=d(t);break;default:throw"mode:"+e}b.push(r),m=null},_.isDark=function(t,e){if(t<0||y<=t||e<0||y<=e)throw t+","+e;return g[t][e]},_.getModuleCount=function(){return y},_.make=function(){if(f<1){for(var t=1;t<40;t++){for(var e=a.getRSBlocks(t,p),r=h(),n=0;n<b.length;n++){var s=b[n];r.put(s.getMode(),4),r.put(s.getLength(),i.getLengthInBits(s.getMode(),t)),s.write(r)}var o=0;for(n=0;n<e.length;n++)o+=e[n].dataCount;if(r.getLengthInBits()<=8*o)break}f=t}v(!1,k())},_.createTableTag=function(t,e){t=t||2,e="undefined"==typeof e?4*t:e;var r="";r+='<table style="',r+=" border-width: 0px; border-style: none;",r+=" border-collapse: collapse;",r+=" padding: 0px; margin: "+e+"px;",r+='">',r+="<tbody>";for(var n=0;n<_.getModuleCount();n+=1){r+="<tr>";for(var i=0;i<_.getModuleCount();i+=1)r+='<td style="',r+=" border-width: 0px; border-style: none;",r+=" border-collapse: collapse;",r+=" padding: 0px; margin: 0px;",r+=" width: "+t+"px;",r+=" height: "+t+"px;",r+=" background-color: ",r+=_.isDark(n,i)?"#000000":"#ffffff",r+=";",r+='"/>';r+="</tr>"}return r+="</tbody>",r+="</table>",r},_.createSvgTag=function(t,e,r,n){var i={};"object"==typeof arguments[0]&&(i=arguments[0],t=i.cellSize,e=i.margin,r=i.alt,n=i.title),t=t||2,e="undefined"==typeof e?4*t:e,r="string"===typeof r?{text:r}:r||{},r.text=r.text||null,r.id=r.text?r.id||"qrcode-description":null,n="string"===typeof n?{text:n}:n||{},n.text=n.text||null,n.id=n.text?n.id||"qrcode-title":null;var s,o,a,h,c,l=_.getModuleCount()*t+2*e,u="";for(c="l"+t+",0 0,"+t+" -"+t+",0 0,-"+t+"z ",u+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',u+=i.scalable?"":' width="'+l+'px" height="'+l+'px"',u+=' viewBox="0 0 '+l+" "+l+'" ',u+=' preserveAspectRatio="xMinYMin meet"',u+=n.text||r.text?' role="img" aria-labelledby="'+B([n.id,r.id].join(" ").trim())+'"':"",u+=">",u+=n.text?'<title id="'+B(n.id)+'">'+B(n.text)+"</title>":"",u+=r.text?'<description id="'+B(r.id)+'">'+B(r.text)+"</description>":"",u+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',u+='<path d="',a=0;a<_.getModuleCount();a+=1)for(h=a*t+e,s=0;s<_.getModuleCount();s+=1)_.isDark(a,s)&&(o=s*t+e,u+="M"+o+","+h+c);return u+='" stroke="transparent" fill="black"/>',u+="</svg>",u},_.createDataURL=function(t,e){t=t||2,e="undefined"==typeof e?4*t:e;var r=_.getModuleCount()*t+2*e,n=e,i=r-e;return w(r,r,(function(e,r){if(n<=e&&e<i&&n<=r&&r<i){var s=Math.floor((e-n)/t),o=Math.floor((r-n)/t);return _.isDark(o,s)?0:1}return 1}))},_.createImgTag=function(t,e,r){t=t||2,e="undefined"==typeof e?4*t:e;var n=_.getModuleCount()*t+2*e,i="";return i+="<img",i+=' src="',i+=_.createDataURL(t,e),i+='"',i+=' width="',i+=n,i+='"',i+=' height="',i+=n,i+='"',r&&(i+=' alt="',i+=B(r),i+='"'),i+="/>",i};var B=function(t){for(var e="",r=0;r<t.length;r+=1){var n=t.charAt(r);switch(n){case"<":e+="&lt;";break;case">":e+="&gt;";break;case"&":e+="&amp;";break;case'"':e+="&quot;";break;default:e+=n;break}}return e},T=function(t){var e=1;t="undefined"==typeof t?2*e:t;var r,n,i,s,o,a=_.getModuleCount()*e+2*t,h=t,c=a-t,l={"██":"█","█ ":"▀"," █":"▄","  ":" "},u={"██":"▀","█ ":"▀"," █":" ","  ":" "},d="";for(r=0;r<a;r+=2){for(i=Math.floor((r-h)/e),s=Math.floor((r+1-h)/e),n=0;n<a;n+=1)o="█",h<=n&&n<c&&h<=r&&r<c&&_.isDark(i,Math.floor((n-h)/e))&&(o=" "),h<=n&&n<c&&h<=r+1&&r+1<c&&_.isDark(s,Math.floor((n-h)/e))?o+=" ":o+="█",d+=t<1&&r+1>=c?u[o]:l[o];d+="\n"}return a%2&&t>0?d.substring(0,d.length-a-1)+Array(a+1).join("▀"):d.substring(0,d.length-1)};return _.createASCII=function(t,e){if(t=t||1,t<2)return T(e);t-=1,e="undefined"==typeof e?2*t:e;var r,n,i,s,o=_.getModuleCount()*t+2*e,a=e,h=o-e,c=Array(t+1).join("██"),l=Array(t+1).join("  "),u="",d="";for(r=0;r<o;r+=1){for(i=Math.floor((r-a)/t),d="",n=0;n<o;n+=1)s=1,a<=n&&n<h&&a<=r&&r<h&&_.isDark(i,Math.floor((n-a)/t))&&(s=0),d+=s?c:l;for(i=0;i<t;i+=1)u+=d+"\n"}return u.substring(0,u.length-1)},_.renderTo2dContext=function(t,e){e=e||2;for(var r=_.getModuleCount(),n=0;n<r;n++)for(var i=0;i<r;i++)t.fillStyle=_.isDark(n,i)?"black":"white",t.fillRect(n*e,i*e,e,e)},_};t.stringToBytesFuncs={default:function(t){for(var e=[],r=0;r<t.length;r+=1){var n=t.charCodeAt(r);e.push(255&n)}return e}},t.stringToBytes=t.stringToBytesFuncs["default"],t.createStringToBytes=function(t,e){var r=function(){var r=g(t),n=function(){var t=r.read();if(-1==t)throw"eof";return t},i=0,s={};while(1){var o=r.read();if(-1==o)break;var a=n(),h=n(),c=n(),l=String.fromCharCode(o<<8|a),u=h<<8|c;s[l]=u,i+=1}if(i!=e)throw i+" != "+e;return s}(),n="?".charCodeAt(0);return function(t){for(var e=[],i=0;i<t.length;i+=1){var s=t.charCodeAt(i);if(s<128)e.push(s);else{var o=r[t.charAt(i)];"number"==typeof o?(255&o)==o?e.push(o):(e.push(o>>>8),e.push(255&o)):e.push(n)}}return e}};var e={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},r={L:1,M:0,Q:3,H:2},n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},i=function(){var t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],r=1335,i=7973,a=21522,h={},c=function(t){var e=0;while(0!=t)e+=1,t>>>=1;return e};return h.getBCHTypeInfo=function(t){var e=t<<10;while(c(e)-c(r)>=0)e^=r<<c(e)-c(r);return(t<<10|e)^a},h.getBCHTypeNumber=function(t){var e=t<<12;while(c(e)-c(i)>=0)e^=i<<c(e)-c(i);return t<<12|e},h.getPatternPosition=function(e){return t[e-1]},h.getMaskFunction=function(t){switch(t){case n.PATTERN000:return function(t,e){return(t+e)%2==0};case n.PATTERN001:return function(t,e){return t%2==0};case n.PATTERN010:return function(t,e){return e%3==0};case n.PATTERN011:return function(t,e){return(t+e)%3==0};case n.PATTERN100:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case n.PATTERN101:return function(t,e){return t*e%2+t*e%3==0};case n.PATTERN110:return function(t,e){return(t*e%2+t*e%3)%2==0};case n.PATTERN111:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw"bad maskPattern:"+t}},h.getErrorCorrectPolynomial=function(t){for(var e=o([1],0),r=0;r<t;r+=1)e=e.multiply(o([1,s.gexp(r)],0));return e},h.getLengthInBits=function(t,r){if(1<=r&&r<10)switch(t){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:return 8;case e.MODE_KANJI:return 8;default:throw"mode:"+t}else if(r<27)switch(t){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw"mode:"+t}else{if(!(r<41))throw"type:"+r;switch(t){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw"mode:"+t}}},h.getLostPoint=function(t){for(var e=t.getModuleCount(),r=0,n=0;n<e;n+=1)for(var i=0;i<e;i+=1){for(var s=0,o=t.isDark(n,i),a=-1;a<=1;a+=1)if(!(n+a<0||e<=n+a))for(var h=-1;h<=1;h+=1)i+h<0||e<=i+h||0==a&&0==h||o==t.isDark(n+a,i+h)&&(s+=1);s>5&&(r+=3+s-5)}for(n=0;n<e-1;n+=1)for(i=0;i<e-1;i+=1){var c=0;t.isDark(n,i)&&(c+=1),t.isDark(n+1,i)&&(c+=1),t.isDark(n,i+1)&&(c+=1),t.isDark(n+1,i+1)&&(c+=1),0!=c&&4!=c||(r+=3)}for(n=0;n<e;n+=1)for(i=0;i<e-6;i+=1)t.isDark(n,i)&&!t.isDark(n,i+1)&&t.isDark(n,i+2)&&t.isDark(n,i+3)&&t.isDark(n,i+4)&&!t.isDark(n,i+5)&&t.isDark(n,i+6)&&(r+=40);for(i=0;i<e;i+=1)for(n=0;n<e-6;n+=1)t.isDark(n,i)&&!t.isDark(n+1,i)&&t.isDark(n+2,i)&&t.isDark(n+3,i)&&t.isDark(n+4,i)&&!t.isDark(n+5,i)&&t.isDark(n+6,i)&&(r+=40);var l=0;for(i=0;i<e;i+=1)for(n=0;n<e;n+=1)t.isDark(n,i)&&(l+=1);var u=Math.abs(100*l/e/e-50)/5;return r+=10*u,r},h}(),s=function(){for(var t=new Array(256),e=new Array(256),r=0;r<8;r+=1)t[r]=1<<r;for(r=8;r<256;r+=1)t[r]=t[r-4]^t[r-5]^t[r-6]^t[r-8];for(r=0;r<255;r+=1)e[t[r]]=r;var n={glog:function(t){if(t<1)throw"glog("+t+")";return e[t]},gexp:function(e){while(e<0)e+=255;while(e>=256)e-=255;return t[e]}};return n}();function o(t,e){if("undefined"==typeof t.length)throw t.length+"/"+e;var r=function(){var r=0;while(r<t.length&&0==t[r])r+=1;for(var n=new Array(t.length-r+e),i=0;i<t.length-r;i+=1)n[i]=t[i+r];return n}(),n={getAt:function(t){return r[t]},getLength:function(){return r.length},multiply:function(t){for(var e=new Array(n.getLength()+t.getLength()-1),r=0;r<n.getLength();r+=1)for(var i=0;i<t.getLength();i+=1)e[r+i]^=s.gexp(s.glog(n.getAt(r))+s.glog(t.getAt(i)));return o(e,0)},mod:function(t){if(n.getLength()-t.getLength()<0)return n;for(var e=s.glog(n.getAt(0))-s.glog(t.getAt(0)),r=new Array(n.getLength()),i=0;i<n.getLength();i+=1)r[i]=n.getAt(i);for(i=0;i<t.getLength();i+=1)r[i]^=s.gexp(s.glog(t.getAt(i))+e);return o(r,0).mod(t)}};return n}var a=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var r={};return r.totalCount=t,r.dataCount=e,r},n={},i=function(e,n){switch(n){case r.L:return t[4*(e-1)+0];case r.M:return t[4*(e-1)+1];case r.Q:return t[4*(e-1)+2];case r.H:return t[4*(e-1)+3];default:return}};return n.getRSBlocks=function(t,r){var n=i(t,r);if("undefined"==typeof n)throw"bad rs block @ typeNumber:"+t+"/errorCorrectionLevel:"+r;for(var s=n.length/3,o=[],a=0;a<s;a+=1)for(var h=n[3*a+0],c=n[3*a+1],l=n[3*a+2],u=0;u<h;u+=1)o.push(e(c,l));return o},n}(),h=function(){var t=[],e=0,r={getBuffer:function(){return t},getAt:function(e){var r=Math.floor(e/8);return 1==(t[r]>>>7-e%8&1)},put:function(t,e){for(var n=0;n<e;n+=1)r.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return e},putBit:function(r){var n=Math.floor(e/8);t.length<=n&&t.push(0),r&&(t[n]|=128>>>e%8),e+=1}};return r},c=function(t){var r=e.MODE_NUMBER,n=t,i={getMode:function(){return r},getLength:function(t){return n.length},write:function(t){var e=n,r=0;while(r+2<e.length)t.put(s(e.substring(r,r+3)),10),r+=3;r<e.length&&(e.length-r==1?t.put(s(e.substring(r,r+1)),4):e.length-r==2&&t.put(s(e.substring(r,r+2)),7))}},s=function(t){for(var e=0,r=0;r<t.length;r+=1)e=10*e+o(t.charAt(r));return e},o=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+t};return i},l=function(t){var r=e.MODE_ALPHA_NUM,n=t,i={getMode:function(){return r},getLength:function(t){return n.length},write:function(t){var e=n,r=0;while(r+1<e.length)t.put(45*s(e.charAt(r))+s(e.charAt(r+1)),11),r+=2;r<e.length&&t.put(s(e.charAt(r)),6)}},s=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);if("A"<=t&&t<="Z")return t.charCodeAt(0)-"A".charCodeAt(0)+10;switch(t){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+t}};return i},u=function(r){var n=e.MODE_8BIT_BYTE,i=t.stringToBytes(r),s={getMode:function(){return n},getLength:function(t){return i.length},write:function(t){for(var e=0;e<i.length;e+=1)t.put(i[e],8)}};return s},d=function(r){var n=e.MODE_KANJI,i=t.stringToBytesFuncs["SJIS"];if(!i)throw"sjis not supported.";!function(t,e){var r=i(t);if(2!=r.length||(r[0]<<8|r[1])!=e)throw"sjis not supported."}("友",38726);var s=i(r),o={getMode:function(){return n},getLength:function(t){return~~(s.length/2)},write:function(t){var e=s,r=0;while(r+1<e.length){var n=(255&e[r])<<8|255&e[r+1];if(33088<=n&&n<=40956)n-=33088;else{if(!(57408<=n&&n<=60351))throw"illegal char at "+(r+1)+"/"+n;n-=49472}n=192*(n>>>8&255)+(255&n),t.put(n,13),r+=2}if(r<e.length)throw"illegal char at "+(r+1)}};return o},f=function(){var t=[],e={writeByte:function(e){t.push(255&e)},writeShort:function(t){e.writeByte(t),e.writeByte(t>>>8)},writeBytes:function(t,r,n){r=r||0,n=n||t.length;for(var i=0;i<n;i+=1)e.writeByte(t[i+r])},writeString:function(t){for(var r=0;r<t.length;r+=1)e.writeByte(t.charCodeAt(r))},toByteArray:function(){return t},toString:function(){var e="";e+="[";for(var r=0;r<t.length;r+=1)r>0&&(e+=","),e+=t[r];return e+="]",e}};return e},p=function(){var t=0,e=0,r=0,n="",i={},s=function(t){n+=String.fromCharCode(o(63&t))},o=function(t){if(t<0);else{if(t<26)return 65+t;if(t<52)return t-26+97;if(t<62)return t-52+48;if(62==t)return 43;if(63==t)return 47}throw"n:"+t};return i.writeByte=function(n){t=t<<8|255&n,e+=8,r+=1;while(e>=6)s(t>>>e-6),e-=6},i.flush=function(){if(e>0&&(s(t<<6-e),t=0,e=0),r%3!=0)for(var i=3-r%3,o=0;o<i;o+=1)n+="="},i.toString=function(){return n},i},g=function(t){var e=t,r=0,n=0,i=0,s={read:function(){while(i<8){if(r>=e.length){if(0==i)return-1;throw"unexpected end of file./"+i}var t=e.charAt(r);if(r+=1,"="==t)return i=0,-1;t.match(/^\s$/)||(n=n<<6|o(t.charCodeAt(0)),i+=6)}var s=n>>>i-8&255;return i-=8,s}},o=function(t){if(65<=t&&t<=90)return t-65;if(97<=t&&t<=122)return t-97+26;if(48<=t&&t<=57)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw"c:"+t};return s},y=function(t,e){var r=t,n=e,i=new Array(t*e),s={setPixel:function(t,e,n){i[e*r+t]=n},write:function(t){t.writeString("GIF87a"),t.writeShort(r),t.writeShort(n),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(r),t.writeShort(n),t.writeByte(0);var e=2,i=a(e);t.writeByte(e);var s=0;while(i.length-s>255)t.writeByte(255),t.writeBytes(i,s,255),s+=255;t.writeByte(i.length-s),t.writeBytes(i,s,i.length-s),t.writeByte(0),t.writeString(";")}},o=function(t){var e=t,r=0,n=0,i={write:function(t,i){if(t>>>i!=0)throw"length over";while(r+i>=8)e.writeByte(255&(t<<r|n)),i-=8-r,t>>>=8-r,n=0,r=0;n|=t<<r,r+=i},flush:function(){r>0&&e.writeByte(n)}};return i},a=function(t){for(var e=1<<t,r=1+(1<<t),n=t+1,s=h(),a=0;a<e;a+=1)s.add(String.fromCharCode(a));s.add(String.fromCharCode(e)),s.add(String.fromCharCode(r));var c=f(),l=o(c);l.write(e,n);var u=0,d=String.fromCharCode(i[u]);u+=1;while(u<i.length){var p=String.fromCharCode(i[u]);u+=1,s.contains(d+p)?d+=p:(l.write(s.indexOf(d),n),s.size()<4095&&(s.size()==1<<n&&(n+=1),s.add(d+p)),d=p)}return l.write(s.indexOf(d),n),l.write(r,n),l.flush(),c.toByteArray()},h=function(){var t={},e=0,r={add:function(n){if(r.contains(n))throw"dup key:"+n;t[n]=e,e+=1},size:function(){return e},indexOf:function(e){return t[e]},contains:function(e){return"undefined"!=typeof t[e]}};return r};return s},w=function(t,e,r){for(var n=y(t,e),i=0;i<e;i+=1)for(var s=0;s<t;s+=1)n.setPixel(s,i,r(s,i));var o=f();n.write(o);for(var a=p(),h=o.toByteArray(),c=0;c<h.length;c+=1)a.writeByte(h[c]);return a.flush(),"data:image/gif;base64,"+a};return t}();!function(){s.stringToBytesFuncs["UTF-8"]=function(t){function e(t){for(var e=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&t.charCodeAt(r)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return e}return e(t)}}(),function(s){n=[],r=s,i="function"===typeof r?r.apply(e,n):r,void 0===i||(t.exports=i)}((function(){return s}))},77613:function(t,e,r){"use strict";r.d(e,{LiquidAuthClient:function(){return Li}});var n={};r.r(n),r.d(n,{Decoder:function(){return ke},Encoder:function(){return ve},PacketType:function(){return _e},protocol:function(){return be}});r(88947);
/*
 * [hi-base32]{@link https://github.com/emn178/hi-base32}
 *
 * @version 0.5.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2021
 * @license MIT
 */
"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split("");const i={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,2:26,3:27,4:28,5:29,6:30,7:31},s=function(t){if(""===t)return[];if(!/^[A-Z2-7=]+$/.test(t))throw new Error("Invalid base32 characters");let e,r,n,s,o,a,h,c;t=t.replace(/=/g,"");const l=[];let u=0;const d=t.length;for(var f=0,p=d>>3<<3;f<p;)e=i[t.charAt(f++)],r=i[t.charAt(f++)],n=i[t.charAt(f++)],s=i[t.charAt(f++)],o=i[t.charAt(f++)],a=i[t.charAt(f++)],h=i[t.charAt(f++)],c=i[t.charAt(f++)],l[u++]=255&(e<<3|r>>>2),l[u++]=255&(r<<6|n<<1|s>>>4),l[u++]=255&(s<<4|o>>>1),l[u++]=255&(o<<7|a<<2|h>>>3),l[u++]=255&(h<<5|c);const g=d-p;return 2===g?(e=i[t.charAt(f++)],r=i[t.charAt(f++)],l[u++]=255&(e<<3|r>>>2)):4===g?(e=i[t.charAt(f++)],r=i[t.charAt(f++)],n=i[t.charAt(f++)],s=i[t.charAt(f++)],l[u++]=255&(e<<3|r>>>2),l[u++]=255&(r<<6|n<<1|s>>>4)):5===g?(e=i[t.charAt(f++)],r=i[t.charAt(f++)],n=i[t.charAt(f++)],s=i[t.charAt(f++)],o=i[t.charAt(f++)],l[u++]=255&(e<<3|r>>>2),l[u++]=255&(r<<6|n<<1|s>>>4),l[u++]=255&(s<<4|o>>>1)):7===g&&(e=i[t.charAt(f++)],r=i[t.charAt(f++)],n=i[t.charAt(f++)],s=i[t.charAt(f++)],o=i[t.charAt(f++)],a=i[t.charAt(f++)],h=i[t.charAt(f++)],l[u++]=255&(e<<3|r>>>2),l[u++]=255&(r<<6|n<<1|s>>>4),l[u++]=255&(s<<4|o>>>1),l[u++]=255&(o<<7|a<<2|h>>>3)),l},o="input is invalid type",a="finalize already called",h="undefined"!==typeof ArrayBuffer,c="0123456789abcdef".split(""),l=[-2147483648,8388608,32768,128],u=[24,16,8,0],d=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],f=["hex","array","digest","arrayBuffer"],p=[],g=Array.isArray,y=ArrayBuffer.isView,w=function(t){const e=typeof t;if("string"===e)return[t,!0];if("object"!==e||null===t)throw new Error(o);if(h&&t.constructor===ArrayBuffer)return[new Uint8Array(t),!1];if(!g(t)&&!y(t))throw new Error(o);return[t,!1]},m=function(t,e){return function(r){return new _(e,!0).update(r)[t]()}},b=function(t){const e=m("hex",t);e.create=function(){return new _(t)},e.update=function(t){return e.create().update(t)};for(let r=0;r<f.length;++r){const n=f[r];e[n]=m(n,t)}return e};function _(t,e){e?(p[0]=p[1]=p[2]=p[3]=p[4]=p[5]=p[6]=p[7]=p[8]=p[9]=p[10]=p[11]=p[12]=p[13]=p[14]=p[15]=p[16]=p[17]=p[18]=p[19]=p[20]=p[21]=p[22]=p[23]=p[24]=p[25]=p[26]=p[27]=p[28]=p[29]=p[30]=p[31]=p[32]=0,this.blocks=p):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],384==t?(this.h0h=3418070365,this.h0l=3238371032,this.h1h=1654270250,this.h1l=914150663,this.h2h=2438529370,this.h2l=812702999,this.h3h=355462360,this.h3l=4144912697,this.h4h=1731405415,this.h4l=4290775857,this.h5h=2394180231,this.h5l=1750603025,this.h6h=3675008525,this.h6l=1694076839,this.h7h=1203062813,this.h7l=3204075428):256==t?(this.h0h=573645204,this.h0l=4230739756,this.h1h=2673172387,this.h1l=3360449730,this.h2h=596883563,this.h2l=1867755857,this.h3h=2520282905,this.h3l=1497426621,this.h4h=2519219938,this.h4l=2827943907,this.h5h=3193839141,this.h5l=1401305490,this.h6h=721525244,this.h6l=746961066,this.h7h=246885852,this.h7l=2177182882):224==t?(this.h0h=2352822216,this.h0l=424955298,this.h1h=1944164710,this.h1l=2312950998,this.h2h=502970286,this.h2l=855612546,this.h3h=1738396948,this.h3l=1479516111,this.h4h=258812777,this.h4l=2077511080,this.h5h=2011393907,this.h5l=79989058,this.h6h=1067287976,this.h6l=1780299464,this.h7h=286451373,this.h7l=2446758561):(this.h0h=1779033703,this.h0l=4089235720,this.h1h=3144134277,this.h1l=2227873595,this.h2h=1013904242,this.h2l=4271175723,this.h3h=2773480762,this.h3l=1595750129,this.h4h=1359893119,this.h4l=2917565137,this.h5h=2600822924,this.h5l=725511199,this.h6h=528734635,this.h6l=4215389547,this.h7h=1541459225,this.h7l=327033209),this.bits=t,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1}function v(t,e,r){const n=w(t);if(t=n[0],n[1]){const e=[],r=t.length;let n,s=0;for(var i=0;i<r;++i)n=t.charCodeAt(i),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<55296||n>=57344?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(n=65536+((1023&n)<<10|1023&t.charCodeAt(++i)),e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);t=e}t.length>128&&(t=new _(e,!0).update(t).array());const s=[],o=[];for(i=0;i<128;++i){const e=t[i]||0;s[i]=92^e,o[i]=54^e}_.call(this,e,r),this.update(o),this.oKeyPad=s,this.inner=!0,this.sharedMemory=r}_.prototype.update=function(t){if(this.finalized)throw new Error(a);const e=w(t);t=e[0];const r=e[1];let n,i,s=0;const o=t.length,h=this.blocks;while(s<o){if(this.hashed&&(this.hashed=!1,h[0]=this.block,this.block=h[1]=h[2]=h[3]=h[4]=h[5]=h[6]=h[7]=h[8]=h[9]=h[10]=h[11]=h[12]=h[13]=h[14]=h[15]=h[16]=h[17]=h[18]=h[19]=h[20]=h[21]=h[22]=h[23]=h[24]=h[25]=h[26]=h[27]=h[28]=h[29]=h[30]=h[31]=h[32]=0),r)for(i=this.start;s<o&&i<128;++s)n=t.charCodeAt(s),n<128?h[i>>>2]|=n<<u[3&i++]:n<2048?(h[i>>>2]|=(192|n>>>6)<<u[3&i++],h[i>>>2]|=(128|63&n)<<u[3&i++]):n<55296||n>=57344?(h[i>>>2]|=(224|n>>>12)<<u[3&i++],h[i>>>2]|=(128|n>>>6&63)<<u[3&i++],h[i>>>2]|=(128|63&n)<<u[3&i++]):(n=65536+((1023&n)<<10|1023&t.charCodeAt(++s)),h[i>>>2]|=(240|n>>>18)<<u[3&i++],h[i>>>2]|=(128|n>>>12&63)<<u[3&i++],h[i>>>2]|=(128|n>>>6&63)<<u[3&i++],h[i>>>2]|=(128|63&n)<<u[3&i++]);else for(i=this.start;s<o&&i<128;++s)h[i>>>2]|=t[s]<<u[3&i++];this.lastByteIndex=i,this.bytes+=i-this.start,i>=128?(this.block=h[32],this.start=i-128,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this},_.prototype.finalize=function(){if(this.finalized)return;this.finalized=!0;const t=this.blocks,e=this.lastByteIndex;t[32]=this.block,t[e>>>2]|=l[3&e],this.block=t[32],e>=112&&(this.hashed||this.hash(),t[0]=this.block,t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=t[16]=t[17]=t[18]=t[19]=t[20]=t[21]=t[22]=t[23]=t[24]=t[25]=t[26]=t[27]=t[28]=t[29]=t[30]=t[31]=t[32]=0),t[30]=this.hBytes<<3|this.bytes>>>29,t[31]=this.bytes<<3,this.hash()},_.prototype.hash=function(){const t=this.h0h,e=this.h0l,r=this.h1h,n=this.h1l,i=this.h2h,s=this.h2l,o=this.h3h,a=this.h3l,h=this.h4h,c=this.h4l,l=this.h5h,u=this.h5l,f=this.h6h,p=this.h6l,g=this.h7h,y=this.h7l,w=this.blocks;let m,b,_,v,A,k,E,x,C,S,O,M,R,B,T,q,I,P,D,N,L,U,$,j,z;for(m=32;m<160;m+=2)N=w[m-30],L=w[m-29],b=(N>>>1|L<<31)^(N>>>8|L<<24)^N>>>7,_=(L>>>1|N<<31)^(L>>>8|N<<24)^(L>>>7|N<<25),N=w[m-4],L=w[m-3],v=(N>>>19|L<<13)^(L>>>29|N<<3)^N>>>6,A=(L>>>19|N<<13)^(N>>>29|L<<3)^(L>>>6|N<<26),N=w[m-32],L=w[m-31],U=w[m-14],$=w[m-13],k=(65535&$)+(65535&L)+(65535&_)+(65535&A),E=($>>>16)+(L>>>16)+(_>>>16)+(A>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(65535&b)+(65535&v)+(E>>>16),C=(U>>>16)+(N>>>16)+(b>>>16)+(v>>>16)+(x>>>16),w[m]=C<<16|65535&x,w[m+1]=E<<16|65535&k;let F=t,V=e,K=r,H=n,Y=i,J=s,W=o,Q=a,X=h,G=c,Z=l,tt=u,et=f,rt=p,nt=g,it=y;for(q=K&Y,I=H&J,m=0;m<160;m+=8)b=(F>>>28|V<<4)^(V>>>2|F<<30)^(V>>>7|F<<25),_=(V>>>28|F<<4)^(F>>>2|V<<30)^(F>>>7|V<<25),v=(X>>>14|G<<18)^(X>>>18|G<<14)^(G>>>9|X<<23),A=(G>>>14|X<<18)^(G>>>18|X<<14)^(X>>>9|G<<23),S=F&K,O=V&H,P=S^F&Y^q,D=O^V&J^I,j=X&Z^~X&et,z=G&tt^~G&rt,N=w[m],L=w[m+1],U=d[m],$=d[m+1],k=(65535&$)+(65535&L)+(65535&z)+(65535&A)+(65535&it),E=($>>>16)+(L>>>16)+(z>>>16)+(A>>>16)+(it>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(65535&j)+(65535&v)+(65535&nt)+(E>>>16),C=(U>>>16)+(N>>>16)+(j>>>16)+(v>>>16)+(nt>>>16)+(x>>>16),N=C<<16|65535&x,L=E<<16|65535&k,k=(65535&D)+(65535&_),E=(D>>>16)+(_>>>16)+(k>>>16),x=(65535&P)+(65535&b)+(E>>>16),C=(P>>>16)+(b>>>16)+(x>>>16),U=C<<16|65535&x,$=E<<16|65535&k,k=(65535&Q)+(65535&L),E=(Q>>>16)+(L>>>16)+(k>>>16),x=(65535&W)+(65535&N)+(E>>>16),C=(W>>>16)+(N>>>16)+(x>>>16),nt=C<<16|65535&x,it=E<<16|65535&k,k=(65535&$)+(65535&L),E=($>>>16)+(L>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(E>>>16),C=(U>>>16)+(N>>>16)+(x>>>16),W=C<<16|65535&x,Q=E<<16|65535&k,b=(W>>>28|Q<<4)^(Q>>>2|W<<30)^(Q>>>7|W<<25),_=(Q>>>28|W<<4)^(W>>>2|Q<<30)^(W>>>7|Q<<25),v=(nt>>>14|it<<18)^(nt>>>18|it<<14)^(it>>>9|nt<<23),A=(it>>>14|nt<<18)^(it>>>18|nt<<14)^(nt>>>9|it<<23),M=W&F,R=Q&V,P=M^W&K^S,D=R^Q&H^O,j=nt&X^~nt&Z,z=it&G^~it&tt,N=w[m+2],L=w[m+3],U=d[m+2],$=d[m+3],k=(65535&$)+(65535&L)+(65535&z)+(65535&A)+(65535&rt),E=($>>>16)+(L>>>16)+(z>>>16)+(A>>>16)+(rt>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(65535&j)+(65535&v)+(65535&et)+(E>>>16),C=(U>>>16)+(N>>>16)+(j>>>16)+(v>>>16)+(et>>>16)+(x>>>16),N=C<<16|65535&x,L=E<<16|65535&k,k=(65535&D)+(65535&_),E=(D>>>16)+(_>>>16)+(k>>>16),x=(65535&P)+(65535&b)+(E>>>16),C=(P>>>16)+(b>>>16)+(x>>>16),U=C<<16|65535&x,$=E<<16|65535&k,k=(65535&J)+(65535&L),E=(J>>>16)+(L>>>16)+(k>>>16),x=(65535&Y)+(65535&N)+(E>>>16),C=(Y>>>16)+(N>>>16)+(x>>>16),et=C<<16|65535&x,rt=E<<16|65535&k,k=(65535&$)+(65535&L),E=($>>>16)+(L>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(E>>>16),C=(U>>>16)+(N>>>16)+(x>>>16),Y=C<<16|65535&x,J=E<<16|65535&k,b=(Y>>>28|J<<4)^(J>>>2|Y<<30)^(J>>>7|Y<<25),_=(J>>>28|Y<<4)^(Y>>>2|J<<30)^(Y>>>7|J<<25),v=(et>>>14|rt<<18)^(et>>>18|rt<<14)^(rt>>>9|et<<23),A=(rt>>>14|et<<18)^(rt>>>18|et<<14)^(et>>>9|rt<<23),B=Y&W,T=J&Q,P=B^Y&F^M,D=T^J&V^R,j=et&nt^~et&X,z=rt&it^~rt&G,N=w[m+4],L=w[m+5],U=d[m+4],$=d[m+5],k=(65535&$)+(65535&L)+(65535&z)+(65535&A)+(65535&tt),E=($>>>16)+(L>>>16)+(z>>>16)+(A>>>16)+(tt>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(65535&j)+(65535&v)+(65535&Z)+(E>>>16),C=(U>>>16)+(N>>>16)+(j>>>16)+(v>>>16)+(Z>>>16)+(x>>>16),N=C<<16|65535&x,L=E<<16|65535&k,k=(65535&D)+(65535&_),E=(D>>>16)+(_>>>16)+(k>>>16),x=(65535&P)+(65535&b)+(E>>>16),C=(P>>>16)+(b>>>16)+(x>>>16),U=C<<16|65535&x,$=E<<16|65535&k,k=(65535&H)+(65535&L),E=(H>>>16)+(L>>>16)+(k>>>16),x=(65535&K)+(65535&N)+(E>>>16),C=(K>>>16)+(N>>>16)+(x>>>16),Z=C<<16|65535&x,tt=E<<16|65535&k,k=(65535&$)+(65535&L),E=($>>>16)+(L>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(E>>>16),C=(U>>>16)+(N>>>16)+(x>>>16),K=C<<16|65535&x,H=E<<16|65535&k,b=(K>>>28|H<<4)^(H>>>2|K<<30)^(H>>>7|K<<25),_=(H>>>28|K<<4)^(K>>>2|H<<30)^(K>>>7|H<<25),v=(Z>>>14|tt<<18)^(Z>>>18|tt<<14)^(tt>>>9|Z<<23),A=(tt>>>14|Z<<18)^(tt>>>18|Z<<14)^(Z>>>9|tt<<23),q=K&Y,I=H&J,P=q^K&W^B,D=I^H&Q^T,j=Z&et^~Z&nt,z=tt&rt^~tt&it,N=w[m+6],L=w[m+7],U=d[m+6],$=d[m+7],k=(65535&$)+(65535&L)+(65535&z)+(65535&A)+(65535&G),E=($>>>16)+(L>>>16)+(z>>>16)+(A>>>16)+(G>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(65535&j)+(65535&v)+(65535&X)+(E>>>16),C=(U>>>16)+(N>>>16)+(j>>>16)+(v>>>16)+(X>>>16)+(x>>>16),N=C<<16|65535&x,L=E<<16|65535&k,k=(65535&D)+(65535&_),E=(D>>>16)+(_>>>16)+(k>>>16),x=(65535&P)+(65535&b)+(E>>>16),C=(P>>>16)+(b>>>16)+(x>>>16),U=C<<16|65535&x,$=E<<16|65535&k,k=(65535&V)+(65535&L),E=(V>>>16)+(L>>>16)+(k>>>16),x=(65535&F)+(65535&N)+(E>>>16),C=(F>>>16)+(N>>>16)+(x>>>16),X=C<<16|65535&x,G=E<<16|65535&k,k=(65535&$)+(65535&L),E=($>>>16)+(L>>>16)+(k>>>16),x=(65535&U)+(65535&N)+(E>>>16),C=(U>>>16)+(N>>>16)+(x>>>16),F=C<<16|65535&x,V=E<<16|65535&k;k=(65535&e)+(65535&V),E=(e>>>16)+(V>>>16)+(k>>>16),x=(65535&t)+(65535&F)+(E>>>16),C=(t>>>16)+(F>>>16)+(x>>>16),this.h0h=C<<16|65535&x,this.h0l=E<<16|65535&k,k=(65535&n)+(65535&H),E=(n>>>16)+(H>>>16)+(k>>>16),x=(65535&r)+(65535&K)+(E>>>16),C=(r>>>16)+(K>>>16)+(x>>>16),this.h1h=C<<16|65535&x,this.h1l=E<<16|65535&k,k=(65535&s)+(65535&J),E=(s>>>16)+(J>>>16)+(k>>>16),x=(65535&i)+(65535&Y)+(E>>>16),C=(i>>>16)+(Y>>>16)+(x>>>16),this.h2h=C<<16|65535&x,this.h2l=E<<16|65535&k,k=(65535&a)+(65535&Q),E=(a>>>16)+(Q>>>16)+(k>>>16),x=(65535&o)+(65535&W)+(E>>>16),C=(o>>>16)+(W>>>16)+(x>>>16),this.h3h=C<<16|65535&x,this.h3l=E<<16|65535&k,k=(65535&c)+(65535&G),E=(c>>>16)+(G>>>16)+(k>>>16),x=(65535&h)+(65535&X)+(E>>>16),C=(h>>>16)+(X>>>16)+(x>>>16),this.h4h=C<<16|65535&x,this.h4l=E<<16|65535&k,k=(65535&u)+(65535&tt),E=(u>>>16)+(tt>>>16)+(k>>>16),x=(65535&l)+(65535&Z)+(E>>>16),C=(l>>>16)+(Z>>>16)+(x>>>16),this.h5h=C<<16|65535&x,this.h5l=E<<16|65535&k,k=(65535&p)+(65535&rt),E=(p>>>16)+(rt>>>16)+(k>>>16),x=(65535&f)+(65535&et)+(E>>>16),C=(f>>>16)+(et>>>16)+(x>>>16),this.h6h=C<<16|65535&x,this.h6l=E<<16|65535&k,k=(65535&y)+(65535&it),E=(y>>>16)+(it>>>16)+(k>>>16),x=(65535&g)+(65535&nt)+(E>>>16),C=(g>>>16)+(nt>>>16)+(x>>>16),this.h7h=C<<16|65535&x,this.h7l=E<<16|65535&k},_.prototype.hex=function(){this.finalize();const t=this.h0h,e=this.h0l,r=this.h1h,n=this.h1l,i=this.h2h,s=this.h2l,o=this.h3h,a=this.h3l,h=this.h4h,l=this.h4l,u=this.h5h,d=this.h5l,f=this.h6h,p=this.h6l,g=this.h7h,y=this.h7l,w=this.bits;let m=c[t>>>28&15]+c[t>>>24&15]+c[t>>>20&15]+c[t>>>16&15]+c[t>>>12&15]+c[t>>>8&15]+c[t>>>4&15]+c[15&t]+c[e>>>28&15]+c[e>>>24&15]+c[e>>>20&15]+c[e>>>16&15]+c[e>>>12&15]+c[e>>>8&15]+c[e>>>4&15]+c[15&e]+c[r>>>28&15]+c[r>>>24&15]+c[r>>>20&15]+c[r>>>16&15]+c[r>>>12&15]+c[r>>>8&15]+c[r>>>4&15]+c[15&r]+c[n>>>28&15]+c[n>>>24&15]+c[n>>>20&15]+c[n>>>16&15]+c[n>>>12&15]+c[n>>>8&15]+c[n>>>4&15]+c[15&n]+c[i>>>28&15]+c[i>>>24&15]+c[i>>>20&15]+c[i>>>16&15]+c[i>>>12&15]+c[i>>>8&15]+c[i>>>4&15]+c[15&i]+c[s>>>28&15]+c[s>>>24&15]+c[s>>>20&15]+c[s>>>16&15]+c[s>>>12&15]+c[s>>>8&15]+c[s>>>4&15]+c[15&s]+c[o>>>28&15]+c[o>>>24&15]+c[o>>>20&15]+c[o>>>16&15]+c[o>>>12&15]+c[o>>>8&15]+c[o>>>4&15]+c[15&o];return w>=256&&(m+=c[a>>>28&15]+c[a>>>24&15]+c[a>>>20&15]+c[a>>>16&15]+c[a>>>12&15]+c[a>>>8&15]+c[a>>>4&15]+c[15&a]),w>=384&&(m+=c[h>>>28&15]+c[h>>>24&15]+c[h>>>20&15]+c[h>>>16&15]+c[h>>>12&15]+c[h>>>8&15]+c[h>>>4&15]+c[15&h]+c[l>>>28&15]+c[l>>>24&15]+c[l>>>20&15]+c[l>>>16&15]+c[l>>>12&15]+c[l>>>8&15]+c[l>>>4&15]+c[15&l]+c[u>>>28&15]+c[u>>>24&15]+c[u>>>20&15]+c[u>>>16&15]+c[u>>>12&15]+c[u>>>8&15]+c[u>>>4&15]+c[15&u]+c[d>>>28&15]+c[d>>>24&15]+c[d>>>20&15]+c[d>>>16&15]+c[d>>>12&15]+c[d>>>8&15]+c[d>>>4&15]+c[15&d]),512==w&&(m+=c[f>>>28&15]+c[f>>>24&15]+c[f>>>20&15]+c[f>>>16&15]+c[f>>>12&15]+c[f>>>8&15]+c[f>>>4&15]+c[15&f]+c[p>>>28&15]+c[p>>>24&15]+c[p>>>20&15]+c[p>>>16&15]+c[p>>>12&15]+c[p>>>8&15]+c[p>>>4&15]+c[15&p]+c[g>>>28&15]+c[g>>>24&15]+c[g>>>20&15]+c[g>>>16&15]+c[g>>>12&15]+c[g>>>8&15]+c[g>>>4&15]+c[15&g]+c[y>>>28&15]+c[y>>>24&15]+c[y>>>20&15]+c[y>>>16&15]+c[y>>>12&15]+c[y>>>8&15]+c[y>>>4&15]+c[15&y]),m},_.prototype.toString=_.prototype.hex,_.prototype.digest=function(){this.finalize();const t=this.h0h,e=this.h0l,r=this.h1h,n=this.h1l,i=this.h2h,s=this.h2l,o=this.h3h,a=this.h3l,h=this.h4h,c=this.h4l,l=this.h5h,u=this.h5l,d=this.h6h,f=this.h6l,p=this.h7h,g=this.h7l,y=this.bits,w=[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o>>>24&255,o>>>16&255,o>>>8&255,255&o];return y>=256&&w.push(a>>>24&255,a>>>16&255,a>>>8&255,255&a),y>=384&&w.push(h>>>24&255,h>>>16&255,h>>>8&255,255&h,c>>>24&255,c>>>16&255,c>>>8&255,255&c,l>>>24&255,l>>>16&255,l>>>8&255,255&l,u>>>24&255,u>>>16&255,u>>>8&255,255&u),512==y&&w.push(d>>>24&255,d>>>16&255,d>>>8&255,255&d,f>>>24&255,f>>>16&255,f>>>8&255,255&f,p>>>24&255,p>>>16&255,p>>>8&255,255&p,g>>>24&255,g>>>16&255,g>>>8&255,255&g),w},_.prototype.array=_.prototype.digest,_.prototype.arrayBuffer=function(){this.finalize();const t=this.bits,e=new ArrayBuffer(t/8),r=new DataView(e);return r.setUint32(0,this.h0h),r.setUint32(4,this.h0l),r.setUint32(8,this.h1h),r.setUint32(12,this.h1l),r.setUint32(16,this.h2h),r.setUint32(20,this.h2l),r.setUint32(24,this.h3h),t>=256&&r.setUint32(28,this.h3l),t>=384&&(r.setUint32(32,this.h4h),r.setUint32(36,this.h4l),r.setUint32(40,this.h5h),r.setUint32(44,this.h5l)),512==t&&(r.setUint32(48,this.h6h),r.setUint32(52,this.h6l),r.setUint32(56,this.h7h),r.setUint32(60,this.h7l)),e},_.prototype.clone=function(){const t=new _(this.bits,!1);return this.copyTo(t),t},_.prototype.copyTo=function(t){let e=0;const r=["h0h","h0l","h1h","h1l","h2h","h2l","h3h","h3l","h4h","h4l","h5h","h5l","h6h","h6l","h7h","h7l","start","bytes","hBytes","finalized","hashed","lastByteIndex"];for(e=0;e<r.length;++e)t[r[e]]=this[r[e]];for(e=0;e<this.blocks.length;++e)t.blocks[e]=this.blocks[e]},v.prototype=new _,v.prototype.finalize=function(){if(_.prototype.finalize.call(this),this.inner){this.inner=!1;const t=this.array();_.call(this,this.bits,this.sharedMemory),this.update(this.oKeyPad),this.update(t),_.prototype.finalize.call(this)}},v.prototype.clone=function(){const t=new v([],this.bits,!1);this.copyTo(t),t.inner=this.inner;for(let e=0;e<this.oKeyPad.length;++e)t.oKeyPad[e]=this.oKeyPad[e];return t};b(256);const A=b(256),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",E=32,x=36,C=4,S=58,O=32,M="Malformed address",R="Bad checksum",B="Invalid base64url input";function T(t){const e=t instanceof Uint8Array?t:new Uint8Array(t),r=e.length;let n="";for(let i=0;i<r;i+=3)n+=k[e[i]>>2],n+=k[(3&e[i])<<4|e[i+1]>>4],n+=k[(15&e[i+1])<<2|e[i+2]>>6],n+=k[63&e[i+2]];return r%3===2?n=n.substring(0,n.length-1):r%3===1&&(n=n.substring(0,n.length-2)),n}function q(t){if("string"!==typeof t)throw new Error(B);return new Uint8Array(atob(t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")).split("").map((t=>t.charCodeAt(0))))}function I(t){if("string"!==typeof t||t.length!==S)throw new Error(M);const e=s(t.toString()),r=new Uint8Array(e.slice(0,x-C)),n=new Uint8Array(e.slice(E,x)),i=A.array(r).slice(O-C,O);if(i.length!==n.length||!Array.from(i).every(((t,e)=>t===n[e])))throw new Error(R);return r}const P={method:"POST",headers:{"Content-Type":"application/json"}};function D(t){return t.ok&&(200===t.status||201===t.status)}const N={attestationType:"none",authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required",requireResidentKey:!1},extensions:{liquid:!0}};function L(t){const e=t.response;return{id:t.id,rawId:T(t.rawId),type:t.type,response:{clientDataJSON:T(e.clientDataJSON),attestationObject:T(e.attestationObject)}}}function U(t,e){const r={...t};if(r.user.id=I(e.address),r.user.name=e.address,r.user.displayName=e.address,r.challenge=q(t.challenge),r.excludeCredentials)for(const n of r.excludeCredentials)n.id=q(n.id);return r}async function $(t,e=N){return await fetch(`${t}/attestation/request`,{...P,body:JSON.stringify(e)})}async function j(t,e){return await fetch(`${t}/attestation/response`,{...P,body:JSON.stringify(e)}).then((t=>{if(!D(t))throw new Error(t.statusText);return t.json()}))}async function z(t,e,r=N){const n=await $(t,r).then((t=>{if(!D(t))throw new Error(t.statusText);return t.json()}));if("undefined"!==typeof n.error)throw new Error(n.error);const i=await e(q(n.challenge)),s=U(n,i),o=L(await navigator.credentials.create({publicKey:s}));return o.clientExtensionResults={liquid:i},await j(t,o)}const F=Object.create(null);F["open"]="0",F["close"]="1",F["ping"]="2",F["pong"]="3",F["message"]="4",F["upgrade"]="5",F["noop"]="6";const V=Object.create(null);Object.keys(F).forEach((t=>{V[F[t]]=t}));const K={type:"error",data:"parser error"},H="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Y="function"===typeof ArrayBuffer,J=t=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,W=({type:t,data:e},r,n)=>H&&e instanceof Blob?r?n(e):Q(e,n):Y&&(e instanceof ArrayBuffer||J(e))?r?n(e):Q(new Blob([e]),n):n(F[t]+(e||"")),Q=(t,e)=>{const r=new FileReader;return r.onload=function(){const t=r.result.split(",")[1];e("b"+(t||""))},r.readAsDataURL(t)};function X(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let G;function Z(t,e){return H&&t.data instanceof Blob?t.data.arrayBuffer().then(X).then(e):Y&&(t.data instanceof ArrayBuffer||J(t.data))?e(X(t.data)):void W(t,!1,(t=>{G||(G=new TextEncoder),e(G.encode(t))}))}const tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",et="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let ji=0;ji<tt.length;ji++)et[tt.charCodeAt(ji)]=ji;const rt=t=>{let e,r,n,i,s,o=.75*t.length,a=t.length,h=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);const c=new ArrayBuffer(o),l=new Uint8Array(c);for(e=0;e<a;e+=4)r=et[t.charCodeAt(e)],n=et[t.charCodeAt(e+1)],i=et[t.charCodeAt(e+2)],s=et[t.charCodeAt(e+3)],l[h++]=r<<2|n>>4,l[h++]=(15&n)<<4|i>>2,l[h++]=(3&i)<<6|63&s;return c},nt="function"===typeof ArrayBuffer,it=(t,e)=>{if("string"!==typeof t)return{type:"message",data:ot(t,e)};const r=t.charAt(0);if("b"===r)return{type:"message",data:st(t.substring(1),e)};const n=V[r];return n?t.length>1?{type:V[r],data:t.substring(1)}:{type:V[r]}:K},st=(t,e)=>{if(nt){const r=rt(t);return ot(r,e)}return{base64:!0,data:t}},ot=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},at=String.fromCharCode(30),ht=(t,e)=>{const r=t.length,n=new Array(r);let i=0;t.forEach(((t,s)=>{W(t,!1,(t=>{n[s]=t,++i===r&&e(n.join(at))}))}))},ct=(t,e)=>{const r=t.split(at),n=[];for(let i=0;i<r.length;i++){const t=it(r[i],e);if(n.push(t),"error"===t.type)break}return n};function lt(){return new TransformStream({transform(t,e){Z(t,(r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const t=new DataView(i.buffer);t.setUint8(0,126),t.setUint16(1,n)}else{i=new Uint8Array(9);const t=new DataView(i.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(n))}t.data&&"string"!==typeof t.data&&(i[0]|=128),e.enqueue(i),e.enqueue(r)}))}})}let ut;function dt(t){return t.reduce(((t,e)=>t+e.length),0)}function ft(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)r[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function pt(t,e){ut||(ut=new TextDecoder);const r=[];let n=0,i=-1,s=!1;return new TransformStream({transform(o,a){r.push(o);while(1){if(0===n){if(dt(r)<1)break;const t=ft(r,1);s=128===(128&t[0]),i=127&t[0],n=i<126?3:126===i?1:2}else if(1===n){if(dt(r)<2)break;const t=ft(r,2);i=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),n=3}else if(2===n){if(dt(r)<8)break;const t=ft(r,8),e=new DataView(t.buffer,t.byteOffset,t.length),s=e.getUint32(0);if(s>Math.pow(2,21)-1){a.enqueue(K);break}i=s*Math.pow(2,32)+e.getUint32(4),n=3}else{if(dt(r)<i)break;const t=ft(r,i);a.enqueue(it(s?t:ut.decode(t),e)),n=0}if(0===i||i>t){a.enqueue(K);break}}}})}const gt=4;function yt(t){if(t)return wt(t)}function wt(t){for(var e in yt.prototype)t[e]=yt.prototype[e];return t}yt.prototype.on=yt.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},yt.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},yt.prototype.off=yt.prototype.removeListener=yt.prototype.removeAllListeners=yt.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<n.length;i++)if(r=n[i],r===e||r.fn===e){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},yt.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);n=0;for(var i=r.length;n<i;++n)r[n].apply(this,e)}return this},yt.prototype.emitReserved=yt.prototype.emit,yt.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},yt.prototype.hasListeners=function(t){return!!this.listeners(t).length};const mt=(()=>{const t="function"===typeof Promise&&"function"===typeof Promise.resolve;return t?t=>Promise.resolve().then(t):(t,e)=>e(t,0)})(),bt=(()=>"undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")())(),_t="arraybuffer";function vt(){}function At(t,...e){return e.reduce(((e,r)=>(t.hasOwnProperty(r)&&(e[r]=t[r]),e)),{})}const kt=bt.setTimeout,Et=bt.clearTimeout;function xt(t,e){e.useNativeTimers?(t.setTimeoutFn=kt.bind(bt),t.clearTimeoutFn=Et.bind(bt)):(t.setTimeoutFn=bt.setTimeout.bind(bt),t.clearTimeoutFn=bt.clearTimeout.bind(bt))}const Ct=1.33;function St(t){return"string"===typeof t?Ot(t):Math.ceil((t.byteLength||t.size)*Ct)}function Ot(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function Mt(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Rt(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function Bt(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let t=r[n].split("=");e[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}return e}class Tt extends Error{constructor(t,e,r){super(t),this.description=e,this.context=r,this.type="TransportError"}}class qt extends yt{constructor(t){super(),this.writable=!1,xt(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,r){return super.emitReserved("error",new Tt(t,e,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=it(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return-1===t.indexOf(":")?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(t){const e=Rt(t);return e.length?"?"+e:""}}class It extends qt{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let t=0;this._polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)};ct(t,this.socket.binaryType).forEach(e),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,ht(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=Mt()),this.supportsBinary||e.sid||(e.b64=1),this.createUri(t,e)}}let Pt=!1;try{Pt="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(Ui){}const Dt=Pt;function Nt(){}class Lt extends It{constructor(t){if(super(t),"undefined"!==typeof location){const e="https:"===location.protocol;let r=location.port;r||(r=e?"443":"80"),this.xd="undefined"!==typeof location&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,e){const r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)})),this.pollXhr=t}}class Ut extends yt{constructor(t,e,r){super(),this.createRequest=t,xt(this,r),this._opts=r,this._method=r.method||"GET",this._uri=e,this._data=void 0!==r.data?r.data:null,this._create()}_create(){var t;const e=At(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(e);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let t in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(t)&&r.setRequestHeader(t,this._opts.extraHeaders[t])}}catch(n){}if("POST"===this._method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(n){}try{r.setRequestHeader("Accept","*/*")}catch(n){}null===(t=this._opts.cookieJar)||void 0===t||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var t;3===r.readyState&&(null===(t=this._opts.cookieJar)||void 0===t||t.parseCookies(r.getResponseHeader("set-cookie"))),4===r.readyState&&(200===r.status||1223===r.status?this._onLoad():this.setTimeoutFn((()=>{this._onError("number"===typeof r.status?r.status:0)}),0))},r.send(this._data)}catch(n){return void this.setTimeoutFn((()=>{this._onError(n)}),0)}"undefined"!==typeof document&&(this._index=Ut.requestsCount++,Ut.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if("undefined"!==typeof this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=Nt,t)try{this._xhr.abort()}catch(e){}"undefined"!==typeof document&&delete Ut.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(Ut.requestsCount=0,Ut.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",$t);else if("function"===typeof addEventListener){const t="onpagehide"in bt?"pagehide":"unload";addEventListener(t,$t,!1)}function $t(){for(let t in Ut.requests)Ut.requests.hasOwnProperty(t)&&Ut.requests[t].abort()}const jt=function(){const t=Ft({xdomain:!1});return t&&null!==t.responseType}();class zt extends Lt{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=jt&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Ut(Ft,this.uri(),t)}}function Ft(t){const e=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!e||Dt))return new XMLHttpRequest}catch(r){}if(!e)try{return new(bt[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(r){}}const Vt="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class Kt extends qt{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,r=Vt?{}:At(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,r)}catch(Ui){return this.emitReserved("error",Ui)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const r=t[e],n=e===t.length-1;W(r,this.supportsBinary,(t=>{try{this.doWrite(r,t)}catch(e){}n&&mt((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=Mt()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const Ht=bt.WebSocket||bt.MozWebSocket;class Yt extends Kt{createSocket(t,e,r){return Vt?new Ht(t,e,r):e?new Ht(t,e):new Ht(t)}doWrite(t,e){this.ws.send(e)}}class Jt extends qt{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(Ui){return this.emitReserved("error",Ui)}this._transport.closed.then((()=>{this.onClose()})).catch((t=>{this.onError("webtransport error",t)})),this._transport.ready.then((()=>{this._transport.createBidirectionalStream().then((t=>{const e=pt(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(e).getReader(),n=lt();n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();const i=()=>{r.read().then((({done:t,value:e})=>{t||(this.onPacket(e),i())})).catch((t=>{}))};i();const s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this._writer.write(s).then((()=>this.onOpen()))}))}))}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const r=t[e],n=e===t.length-1;this._writer.write(r).then((()=>{n&&mt((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var t;null===(t=this._transport)||void 0===t||t.close()}}const Wt={websocket:Yt,webtransport:Jt,polling:zt},Qt=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Xt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Gt(t){if(t.length>8e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");-1!=r&&-1!=n&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=Qt.exec(t||""),s={},o=14;while(o--)s[Xt[o]]=i[o]||"";return-1!=r&&-1!=n&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=Zt(s,s["path"]),s.queryKey=te(s,s["query"]),s}function Zt(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return"/"!=e.slice(0,1)&&0!==e.length||n.splice(0,1),"/"==e.slice(-1)&&n.splice(n.length-1,1),n}function te(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(r[e]=n)})),r}const ee="function"===typeof addEventListener&&"function"===typeof removeEventListener,re=[];ee&&addEventListener("offline",(()=>{re.forEach((t=>t()))}),!1);class ne extends yt{constructor(t,e){if(super(),this.binaryType=_t,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&"object"===typeof t&&(e=t,t=null),t){const r=Gt(t);e.hostname=r.host,e.secure="https"===r.protocol||"wss"===r.protocol,e.port=r.port,r.query&&(e.query=r.query)}else e.host&&(e.hostname=Gt(e.host).host);xt(this,e),this.secure=null!=e.secure?e.secure:"undefined"!==typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach((t=>{const e=t.prototype.name;this.transports.push(e),this._transportsByName[e]=t})),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=Bt(this.opts.query)),ee&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},re.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=vt()),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=gt,e.transport=t,this.id&&(e.sid=this.id);const r=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);const t=this.opts.rememberUpgrade&&ne.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(t=>this._onClose("transport close",t)))}onOpen(){this.readyState="open",ne.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn((()=>{this._onClose("ping timeout")}),t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){const t=this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!t)return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){const t=this.writeBuffer[r].data;if(t&&(e+=St(t)),r>0&&e>this._maxPayload)return this.writeBuffer.slice(0,r);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,mt((()=>{this._onClose("ping timeout")}),this.setTimeoutFn)),t}write(t,e,r){return this._sendPacket("message",t,e,r),this}send(t,e,r){return this._sendPacket("message",t,e,r),this}_sendPacket(t,e,r,n){if("function"===typeof e&&(n=e,e=void 0),"function"===typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;r=r||{},r.compress=!1!==r.compress;const i={type:t,data:e,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},r=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?r():t()})):this.upgrading?r():t()),this}_onError(t){if(ne.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ee&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const t=re.indexOf(this._offlineEventListener);-1!==t&&re.splice(t,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}ne.protocol=gt;class ie extends ne{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),r=!1;ne.priorWebsocketSuccess=!1;const n=()=>{r||(e.send([{type:"ping",data:"probe"}]),e.once("packet",(t=>{if(!r)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ne.priorWebsocketSuccess="websocket"===e.name,this.transport.pause((()=>{r||"closed"!==this.readyState&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}})))};function i(){r||(r=!0,c(),e.close(),e=null)}const s=t=>{const r=new Error("probe error: "+t);r.transport=e.name,i(),this.emitReserved("upgradeError",r)};function o(){s("transport closed")}function a(){s("socket closed")}function h(t){e&&t.name!==e.name&&i()}const c=()=>{e.removeListener("open",n),e.removeListener("error",s),e.removeListener("close",o),this.off("close",a),this.off("upgrading",h)};e.once("open",n),e.once("error",s),e.once("close",o),this.once("close",a),this.once("upgrading",h),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn((()=>{r||e.open()}),200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&e.push(t[r]);return e}}class se extends ie{constructor(t,e={}){const r="object"===typeof t?t:e;(!r.transports||r.transports&&"string"===typeof r.transports[0])&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map((t=>Wt[t])).filter((t=>!!t))),super(t,r)}}se.protocol;function oe(t,e="",r){let n=t;r=r||"undefined"!==typeof location&&location,null==t&&(t=r.protocol+"//"+r.host),"string"===typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?r.protocol+t:r.host+t),/^(https?|wss?):\/\//.test(t)||(t="undefined"!==typeof r?r.protocol+"//"+t:"https://"+t),n=Gt(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=-1!==n.host.indexOf(":"),s=i?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}const ae="function"===typeof ArrayBuffer,he=t=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,ce=Object.prototype.toString,le="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===ce.call(Blob),ue="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===ce.call(File);function de(t){return ae&&(t instanceof ArrayBuffer||he(t))||le&&t instanceof Blob||ue&&t instanceof File}function fe(t,e){if(!t||"object"!==typeof t)return!1;if(Array.isArray(t)){for(let e=0,r=t.length;e<r;e++)if(fe(t[e]))return!0;return!1}if(de(t))return!0;if(t.toJSON&&"function"===typeof t.toJSON&&1===arguments.length)return fe(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&fe(t[r]))return!0;return!1}function pe(t){const e=[],r=t.data,n=t;return n.data=ge(r,e),n.attachments=e.length,{packet:n,buffers:e}}function ge(t,e){if(!t)return t;if(de(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=ge(t[n],e);return r}if("object"===typeof t&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=ge(t[n],e));return r}return t}function ye(t,e){return t.data=we(t.data,e),delete t.attachments,t}function we(t,e){if(!t)return t;if(t&&!0===t._placeholder){const r="number"===typeof t.num&&t.num>=0&&t.num<e.length;if(r)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=we(t[r],e);else if("object"===typeof t)for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=we(t[r],e));return t}const me=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],be=5;var _e;(function(t){t[t["CONNECT"]=0]="CONNECT",t[t["DISCONNECT"]=1]="DISCONNECT",t[t["EVENT"]=2]="EVENT",t[t["ACK"]=3]="ACK",t[t["CONNECT_ERROR"]=4]="CONNECT_ERROR",t[t["BINARY_EVENT"]=5]="BINARY_EVENT",t[t["BINARY_ACK"]=6]="BINARY_ACK"})(_e||(_e={}));class ve{constructor(t){this.replacer=t}encode(t){return t.type!==_e.EVENT&&t.type!==_e.ACK||!fe(t)?[this.encodeAsString(t)]:this.encodeAsBinary({type:t.type===_e.EVENT?_e.BINARY_EVENT:_e.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}encodeAsString(t){let e=""+t.type;return t.type!==_e.BINARY_EVENT&&t.type!==_e.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=pe(t),r=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(r),n}}function Ae(t){return"[object Object]"===Object.prototype.toString.call(t)}class ke extends yt{constructor(t){super(),this.reviver=t}add(t){let e;if("string"===typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const r=e.type===_e.BINARY_EVENT;r||e.type===_e.BINARY_ACK?(e.type=r?_e.EVENT:_e.ACK,this.reconstructor=new Ee(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!de(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const r={type:Number(t.charAt(0))};if(void 0===_e[r.type])throw new Error("unknown packet type "+r.type);if(r.type===_e.BINARY_EVENT||r.type===_e.BINARY_ACK){const n=e+1;while("-"!==t.charAt(++e)&&e!=t.length);const i=t.substring(n,e);if(i!=Number(i)||"-"!==t.charAt(e))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===t.charAt(e+1)){const n=e+1;while(++e){const r=t.charAt(e);if(","===r)break;if(e===t.length)break}r.nsp=t.substring(n,e)}else r.nsp="/";const n=t.charAt(e+1);if(""!==n&&Number(n)==n){const n=e+1;while(++e){const r=t.charAt(e);if(null==r||Number(r)!=r){--e;break}if(e===t.length)break}r.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=this.tryParse(t.substr(e));if(!ke.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(e){return!1}}static isPayloadValid(t,e){switch(t){case _e.CONNECT:return Ae(e);case _e.DISCONNECT:return void 0===e;case _e.CONNECT_ERROR:return"string"===typeof e||Ae(e);case _e.EVENT:case _e.BINARY_EVENT:return Array.isArray(e)&&("number"===typeof e[0]||"string"===typeof e[0]&&-1===me.indexOf(e[0]));case _e.ACK:case _e.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ee{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=ye(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function xe(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const Ce=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Se extends yt{constructor(t,e,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[xe(t,"open",this.onopen.bind(this)),xe(t,"packet",this.onpacket.bind(this)),xe(t,"error",this.onerror.bind(this)),xe(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io["_reconnecting"]||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var r,n,i;if(Ce.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const s={type:_e.EVENT,data:e,options:{}};if(s.options.compress=!1!==this.flags.compress,"function"===typeof e[e.length-1]){const t=this.ids++,r=e.pop();this._registerAckCallback(t,r),s.id=t}const o=null===(n=null===(r=this.io.engine)||void 0===r?void 0:r.transport)||void 0===n?void 0:n.writable,a=this.connected&&!(null===(i=this.io.engine)||void 0===i?void 0:i._hasPingExpired()),h=this.flags.volatile&&!o;return h||(a?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(t,e){var r;const n=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0===n)return void(this.acks[t]=e);const i=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))}),n),s=(...t)=>{this.io.clearTimeoutFn(i),e.apply(this,t)};s.withError=!0,this.acks[t]=s}emitWithAck(t,...e){return new Promise(((r,n)=>{const i=(t,e)=>t?n(t):r(e);i.withError=!0,e.push(i),this.emit(t,...e)}))}_addToQueue(t){let e;"function"===typeof t[t.length-1]&&(e=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push(((t,...n)=>{if(r!==this._queue[0])return;const i=null!==t;return i?r.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(t)):(this._queue.shift(),e&&e(null,...n)),r.pending=!1,this._drainQueue()})),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||0===this._queue.length)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth((t=>{this._sendConnectPacket(t)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:_e.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((t=>{const e=this.sendBuffer.some((e=>String(e.id)===t));if(!e){const e=this.acks[t];delete this.acks[t],e.withError&&e.call(this,new Error("socket has been disconnected"))}}))}onpacket(t){const e=t.nsp===this.nsp;if(e)switch(t.type){case _e.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case _e.EVENT:case _e.BINARY_EVENT:this.onevent(t);break;case _e.ACK:case _e.BINARY_ACK:this.onack(t);break;case _e.DISCONNECT:this.ondisconnect();break;case _e.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e);break}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const r of e)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&"string"===typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let r=!1;return function(...n){r||(r=!0,e.packet({type:_e.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];"function"===typeof e&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t),this.packet(t)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io["_destroy"](this)}disconnect(){return this.connected&&this.packet({type:_e.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const r of e)r.apply(this,t.data)}}}function Oe(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Oe.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-r:t+r}return 0|Math.min(t,this.max)},Oe.prototype.reset=function(){this.attempts=0},Oe.prototype.setMin=function(t){this.ms=t},Oe.prototype.setMax=function(t){this.max=t},Oe.prototype.setJitter=function(t){this.jitter=t};class Me extends yt{constructor(t,e){var r;super(),this.nsps={},this.subs=[],t&&"object"===typeof t&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,xt(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=e.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new Oe({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const i=e.parser||n;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new se(this.uri,this.opts);const e=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=xe(e,"open",(function(){r.onopen(),t&&t()})),i=e=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",e),t?t(e):this.maybeReconnectOnOpen()},s=xe(e,"error",i);if(!1!==this._timeout){const t=this._timeout,r=this.setTimeoutFn((()=>{n(),i(new Error("timeout")),e.close()}),t);this.opts.autoUnref&&r.unref(),this.subs.push((()=>{this.clearTimeoutFn(r)}))}return this.subs.push(n),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(xe(t,"ping",this.onping.bind(this)),xe(t,"data",this.ondata.bind(this)),xe(t,"error",this.onerror.bind(this)),xe(t,"close",this.onclose.bind(this)),xe(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){mt((()=>{this.emitReserved("packet",t)}),this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new Se(this,t,e),this.nsps[t]=r),r}_destroy(t){const e=Object.keys(this.nsps);for(const r of e){const t=this.nsps[r];if(t.active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let r=0;r<e.length;r++)this.engine.write(e[r],t.options)}cleanup(){this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var r;this.cleanup(),null===(r=this.engine)||void 0===r||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn((()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()})))}),e);this.opts.autoUnref&&r.unref(),this.subs.push((()=>{this.clearTimeoutFn(r)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Re={};function Be(t,e){"object"===typeof t&&(e=t,t=void 0),e=e||{};const r=oe(t,e.path||"/socket.io"),n=r.source,i=r.id,s=r.path,o=Re[i]&&s in Re[i]["nsps"],a=e.forceNew||e["force new connection"]||!1===e.multiplex||o;let h;return a?h=new Me(n,e):(Re[i]||(Re[i]=new Me(n,e)),h=Re[i]),r.query&&!e.query&&(e.query=r.queryKey),h.socket(r.path,e)}Object.assign(Be,{Manager:Me,Socket:Se,io:Be,connect:Be});var Te={numeric:"Numeric",alphanumeric:"Alphanumeric",byte:"Byte",kanji:"Kanji"};function qe(t){switch(!0){case/^[0-9]*$/.test(t):return Te.numeric;case/^[0-9A-Z $%*+\-./:]*$/.test(t):return Te.alphanumeric;default:return Te.byte}}const Ie=t=>!!t&&"object"===typeof t&&!Array.isArray(t);function Pe(t,...e){if(!e.length)return t;const r=e.shift();return void 0!==r&&Ie(t)&&Ie(r)?(t={...t},Object.keys(r).forEach((e=>{const n=t[e],i=r[e];Array.isArray(n)&&Array.isArray(i)?t[e]=i:Ie(n)&&Ie(i)?t[e]=Pe(Object.assign({},n),i):t[e]=i})),Pe(t,...e)):t}function De(t,e){const r=document.createElement("a");r.download=e,r.href=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}function Ne({originalHeight:t,originalWidth:e,maxHiddenDots:r,maxHiddenAxisDots:n,dotSize:i}){const s={x:0,y:0},o={x:0,y:0};if(t<=0||e<=0||r<=0||i<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};const a=t/e;return s.x=Math.floor(Math.sqrt(r/a)),s.x<=0&&(s.x=1),n&&n<s.x&&(s.x=n),s.x%2===0&&s.x--,o.x=s.x*i,s.y=1+2*Math.ceil((s.x*a-1)/2),o.y=Math.round(o.x*a),(s.y*s.x>r||n&&n<s.y)&&(n&&n<s.y?(s.y=n,s.y%2===0&&s.x--):s.y-=2,o.y=s.y*i,s.x=1+2*Math.ceil((s.y/a-1)/2),o.x=Math.round(o.y/a)),{height:o.y,width:o.x,hideYDots:s.y,hideXDots:s.x}}async function Le(t){return new Promise((e=>{const r=new XMLHttpRequest;r.onload=function(){const t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(r.response)},r.open("GET",t),r.responseType="blob",r.send()}))}var Ue={L:.07,M:.15,Q:.25,H:.3},$e={dots:"dots",rounded:"rounded",classy:"classy",classyRounded:"classy-rounded",square:"square",extraRounded:"extra-rounded"};class je{constructor({svg:t,type:e}){this._svg=t,this._type=e}draw(t,e,r,n){const i=this._type;let s;switch(i){case $e.dots:s=this._drawDot;break;case $e.classy:s=this._drawClassy;break;case $e.classyRounded:s=this._drawClassyRounded;break;case $e.rounded:s=this._drawRounded;break;case $e.extraRounded:s=this._drawExtraRounded;break;case $e.square:default:s=this._drawSquare}s.call(this,{x:t,y:e,size:r,getNeighbor:n})}_rotateFigure({x:t,y:e,size:r,rotation:n=0,draw:i}){const s=t+r/2,o=e+r/2;i(),this._element?.setAttribute("transform",`rotate(${180*n/Math.PI},${s},${o})`)}_basicDot(t){const{size:e,x:r,y:n}=t;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(r+e/2)),this._element.setAttribute("cy",String(n+e/2)),this._element.setAttribute("r",String(e/2))}})}_basicSquare(t){const{size:e,x:r,y:n}=t;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(r)),this._element.setAttribute("y",String(n)),this._element.setAttribute("width",String(e)),this._element.setAttribute("height",String(e))}})}_basicSideRounded(t){const{size:e,x:r,y:n}=t;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${r} ${n}v ${e}h `+e/2+`a ${e/2} ${e/2}, 0, 0, 0, 0 ${-e}`)}})}_basicCornerRounded(t){const{size:e,x:r,y:n}=t;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${r} ${n}v ${e}h ${e}v `+-e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${-e/2} ${-e/2}`)}})}_basicCornerExtraRounded(t){const{size:e,x:r,y:n}=t;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${r} ${n}v ${e}h ${e}a ${e} ${e}, 0, 0, 0, ${-e} ${-e}`)}})}_basicCornersRounded(t){const{size:e,x:r,y:n}=t;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${r} ${n}v `+e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${e/2} ${e/2}h `+e/2+"v "+-e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${-e/2} ${-e/2}`)}})}_drawDot({x:t,y:e,size:r}){this._basicDot({x:t,y:e,size:r,rotation:0})}_drawSquare({x:t,y:e,size:r}){this._basicSquare({x:t,y:e,size:r,rotation:0})}_drawRounded({x:t,y:e,size:r,getNeighbor:n}){const i=n?+n(-1,0):0,s=n?+n(1,0):0,o=n?+n(0,-1):0,a=n?+n(0,1):0,h=i+s+o+a;if(0!==h)if(h>2||i&&s||o&&a)this._basicSquare({x:t,y:e,size:r,rotation:0});else{if(2===h){let n=0;return i&&o?n=Math.PI/2:o&&s?n=Math.PI:s&&a&&(n=-Math.PI/2),void this._basicCornerRounded({x:t,y:e,size:r,rotation:n})}if(1===h){let n=0;return o?n=Math.PI/2:s?n=Math.PI:a&&(n=-Math.PI/2),void this._basicSideRounded({x:t,y:e,size:r,rotation:n})}}else this._basicDot({x:t,y:e,size:r,rotation:0})}_drawExtraRounded({x:t,y:e,size:r,getNeighbor:n}){const i=n?+n(-1,0):0,s=n?+n(1,0):0,o=n?+n(0,-1):0,a=n?+n(0,1):0,h=i+s+o+a;if(0!==h)if(h>2||i&&s||o&&a)this._basicSquare({x:t,y:e,size:r,rotation:0});else{if(2===h){let n=0;return i&&o?n=Math.PI/2:o&&s?n=Math.PI:s&&a&&(n=-Math.PI/2),void this._basicCornerExtraRounded({x:t,y:e,size:r,rotation:n})}if(1===h){let n=0;return o?n=Math.PI/2:s?n=Math.PI:a&&(n=-Math.PI/2),void this._basicSideRounded({x:t,y:e,size:r,rotation:n})}}else this._basicDot({x:t,y:e,size:r,rotation:0})}_drawClassy({x:t,y:e,size:r,getNeighbor:n}){const i=n?+n(-1,0):0,s=n?+n(1,0):0,o=n?+n(0,-1):0,a=n?+n(0,1):0,h=i+s+o+a;0!==h?i||o?s||a?this._basicSquare({x:t,y:e,size:r,rotation:0}):this._basicCornerRounded({x:t,y:e,size:r,rotation:Math.PI/2}):this._basicCornerRounded({x:t,y:e,size:r,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:e,size:r,rotation:Math.PI/2})}_drawClassyRounded({x:t,y:e,size:r,getNeighbor:n}){const i=n?+n(-1,0):0,s=n?+n(1,0):0,o=n?+n(0,-1):0,a=n?+n(0,1):0,h=i+s+o+a;0!==h?i||o?s||a?this._basicSquare({x:t,y:e,size:r,rotation:0}):this._basicCornerExtraRounded({x:t,y:e,size:r,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:t,y:e,size:r,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:e,size:r,rotation:Math.PI/2})}}var ze={dot:"dot",square:"square",extraRounded:"extra-rounded"};class Fe{constructor({svg:t,type:e}){this._svg=t,this._type=e}draw(t,e,r,n){const i=this._type;let s;switch(i){case ze.square:s=this._drawSquare;break;case ze.extraRounded:s=this._drawExtraRounded;break;case ze.dot:default:s=this._drawDot}s.call(this,{x:t,y:e,size:r,rotation:n})}_rotateFigure({x:t,y:e,size:r,rotation:n=0,draw:i}){const s=t+r/2,o=e+r/2;i(),this._element?.setAttribute("transform",`rotate(${180*n/Math.PI},${s},${o})`)}_basicDot(t){const{size:e,x:r,y:n}=t,i=e/7;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${r+e/2} ${n}a ${e/2} ${e/2} 0 1 0 0.1 0zm 0 ${i}a ${e/2-i} ${e/2-i} 0 1 1 -0.1 0Z`)}})}_basicSquare(t){const{size:e,x:r,y:n}=t,i=e/7;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${r} ${n}v ${e}h ${e}v `+-e+"z"+`M ${r+i} ${n+i}h `+(e-2*i)+"v "+(e-2*i)+"h "+(2*i-e)+"z")}})}_basicExtraRounded(t){const{size:e,x:r,y:n}=t,i=e/7;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${r} ${n+2.5*i}v `+2*i+`a ${2.5*i} ${2.5*i}, 0, 0, 0, ${2.5*i} ${2.5*i}h `+2*i+`a ${2.5*i} ${2.5*i}, 0, 0, 0, ${2.5*i} ${2.5*-i}v `+-2*i+`a ${2.5*i} ${2.5*i}, 0, 0, 0, ${2.5*-i} ${2.5*-i}h `+-2*i+`a ${2.5*i} ${2.5*i}, 0, 0, 0, ${2.5*-i} ${2.5*i}`+`M ${r+2.5*i} ${n+i}h `+2*i+`a ${1.5*i} ${1.5*i}, 0, 0, 1, ${1.5*i} ${1.5*i}v `+2*i+`a ${1.5*i} ${1.5*i}, 0, 0, 1, ${1.5*-i} ${1.5*i}h `+-2*i+`a ${1.5*i} ${1.5*i}, 0, 0, 1, ${1.5*-i} ${1.5*-i}v `+-2*i+`a ${1.5*i} ${1.5*i}, 0, 0, 1, ${1.5*i} ${1.5*-i}`)}})}_drawDot({x:t,y:e,size:r,rotation:n}){this._basicDot({x:t,y:e,size:r,rotation:n})}_drawSquare({x:t,y:e,size:r,rotation:n}){this._basicSquare({x:t,y:e,size:r,rotation:n})}_drawExtraRounded({x:t,y:e,size:r,rotation:n}){this._basicExtraRounded({x:t,y:e,size:r,rotation:n})}}var Ve={dot:"dot",square:"square"};class Ke{constructor({svg:t,type:e}){this._svg=t,this._type=e}draw(t,e,r,n){const i=this._type;let s;switch(i){case Ve.square:s=this._drawSquare;break;case Ve.dot:default:s=this._drawDot}s.call(this,{x:t,y:e,size:r,rotation:n})}_rotateFigure({x:t,y:e,size:r,rotation:n=0,draw:i}){const s=t+r/2,o=e+r/2;i(),this._element?.setAttribute("transform",`rotate(${180*n/Math.PI},${s},${o})`)}_basicDot(t){const{size:e,x:r,y:n}=t;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(r+e/2)),this._element.setAttribute("cy",String(n+e/2)),this._element.setAttribute("r",String(e/2))}})}_basicSquare(t){const{size:e,x:r,y:n}=t;this._rotateFigure({...t,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(r)),this._element.setAttribute("y",String(n)),this._element.setAttribute("width",String(e)),this._element.setAttribute("height",String(e))}})}_drawDot({x:t,y:e,size:r,rotation:n}){this._basicDot({x:t,y:e,size:r,rotation:n})}_drawSquare({x:t,y:e,size:r,rotation:n}){this._basicSquare({x:t,y:e,size:r,rotation:n})}}var He={radial:"radial",linear:"linear"},Ye={square:"square",circle:"circle"};const Je=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],We=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class Qe{constructor(t){this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(t.width)),this._element.setAttribute("height",String(t.height)),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._options=t}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}async drawQR(t){const e=t.getModuleCount(),r=Math.min(this._options.width,this._options.height)-2*this._options.margin,n=this._options.shape===Ye.circle?r/Math.sqrt(2):r,i=Math.floor(n/e);let s={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=t,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:t,qrOptions:r}=this._options,n=t.imageSize*Ue[r.errorCorrectionLevel],o=Math.floor(n*e*e);s=Ne({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:o,maxHiddenAxisDots:e-14,dotSize:i})}this.drawBackground(),this.drawDots(((t,r)=>!(this._options.imageOptions.hideBackgroundDots&&t>=(e-s.hideXDots)/2&&t<(e+s.hideXDots)/2&&r>=(e-s.hideYDots)/2&&r<(e+s.hideYDots)/2)&&(!(Je[t]?.[r]||Je[t-e+7]?.[r]||Je[t]?.[r-e+7])&&!(We[t]?.[r]||We[t-e+7]?.[r]||We[t]?.[r-e+7])))),this.drawCorners(),this._options.image&&await this.drawImage({width:s.width,height:s.height,count:e,dotSize:i})}drawBackground(){const t=this._element,e=this._options;if(t){const t=e.backgroundOptions?.gradient,r=e.backgroundOptions?.color;if((t||r)&&this._createColor({options:t,color:r,additionalRotation:0,x:0,y:0,height:e.height,width:e.width,name:"background-color"}),e.backgroundOptions?.round){const t=Math.min(e.width,e.height),r=document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id","clip-path-background-color"),this._defs.appendChild(this._backgroundClipPath),r.setAttribute("x",String((e.width-t)/2)),r.setAttribute("y",String((e.height-t)/2)),r.setAttribute("width",String(t)),r.setAttribute("height",String(t)),r.setAttribute("rx",String(t/2*e.backgroundOptions.round)),this._backgroundClipPath.appendChild(r)}}}drawDots(t){if(!this._qr)throw"QR code is not defined";const e=this._options,r=this._qr.getModuleCount();if(r>e.width||r>e.height)throw"The canvas is too small.";const n=Math.min(e.width,e.height)-2*e.margin,i=e.shape===Ye.circle?n/Math.sqrt(2):n,s=Math.floor(i/r),o=Math.floor((e.width-r*s)/2),a=Math.floor((e.height-r*s)/2),h=new je({svg:this._element,type:e.dotsOptions.type});this._dotsClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id","clip-path-dot-color"),this._defs.appendChild(this._dotsClipPath),this._createColor({options:e.dotsOptions?.gradient,color:e.dotsOptions.color,additionalRotation:0,x:0,y:0,height:e.height,width:e.width,name:"dot-color"});for(let c=0;c<r;c++)for(let e=0;e<r;e++)t&&!t(c,e)||this._qr?.isDark(c,e)&&(h.draw(o+c*s,a+e*s,s,((n,i)=>!(c+n<0||e+i<0||c+n>=r||e+i>=r)&&(!(t&&!t(c+n,e+i))&&(!!this._qr&&this._qr.isDark(c+n,e+i))))),h._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(h._element));if(e.shape===Ye.circle){const t=Math.floor((n/s-r)/2),e=r+2*t,i=o-t*s,c=a-t*s,l=[],u=Math.floor(e/2);for(let n=0;n<e;n++){l[n]=[];for(let i=0;i<e;i++)n>=t-1&&n<=e-t&&i>=t-1&&i<=e-t||Math.sqrt((n-u)*(n-u)+(i-u)*(i-u))>u?l[n][i]=0:l[n][i]=this._qr.isDark(i-2*t<0?i:i>=r?i-2*t:i-t,n-2*t<0?n:n>=r?n-2*t:n-t)?1:0}for(let r=0;r<e;r++)for(let t=0;t<e;t++)l[r][t]&&(h.draw(i+r*s,c+t*s,s,((e,n)=>!!l[r+e]?.[t+n])),h._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(h._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";const t=this._element,e=this._options;if(!t)throw"Element code is not defined";const r=this._qr.getModuleCount(),n=Math.min(e.width,e.height)-2*e.margin,i=e.shape===Ye.circle?n/Math.sqrt(2):n,s=Math.floor(i/r),o=7*s,a=3*s,h=Math.floor((e.width-r*s)/2),c=Math.floor((e.height-r*s)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach((([t,n,i])=>{const l=h+t*s*(r-7),u=c+n*s*(r-7);let d=this._dotsClipPath,f=this._dotsClipPath;if((e.cornersSquareOptions?.gradient||e.cornersSquareOptions?.color)&&(d=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),d.setAttribute("id",`clip-path-corners-square-color-${t}-${n}`),this._defs.appendChild(d),this._cornersSquareClipPath=this._cornersDotClipPath=f=d,this._createColor({options:e.cornersSquareOptions?.gradient,color:e.cornersSquareOptions?.color,additionalRotation:i,x:l,y:u,height:o,width:o,name:`corners-square-color-${t}-${n}`})),e.cornersSquareOptions?.type){const t=new Fe({svg:this._element,type:e.cornersSquareOptions.type});t.draw(l,u,o,i),t._element&&d&&d.appendChild(t._element)}else{const t=new je({svg:this._element,type:e.dotsOptions.type});for(let e=0;e<Je.length;e++)for(let r=0;r<Je[e].length;r++)Je[e]?.[r]&&(t.draw(l+e*s,u+r*s,s,((t,n)=>!!Je[e+t]?.[r+n])),t._element&&d&&d.appendChild(t._element))}if((e.cornersDotOptions?.gradient||e.cornersDotOptions?.color)&&(f=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),f.setAttribute("id",`clip-path-corners-dot-color-${t}-${n}`),this._defs.appendChild(f),this._cornersDotClipPath=f,this._createColor({options:e.cornersDotOptions?.gradient,color:e.cornersDotOptions?.color,additionalRotation:i,x:l+2*s,y:u+2*s,height:a,width:a,name:`corners-dot-color-${t}-${n}`})),e.cornersDotOptions?.type){const t=new Ke({svg:this._element,type:e.cornersDotOptions.type});t.draw(l+2*s,u+2*s,a,i),t._element&&f&&f.appendChild(t._element)}else{const t=new je({svg:this._element,type:e.dotsOptions.type});for(let e=0;e<We.length;e++)for(let r=0;r<We[e].length;r++)We[e]?.[r]&&(t.draw(l+e*s,u+r*s,s,((t,n)=>!!We[e+t]?.[r+n])),t._element&&f&&f.appendChild(t._element))}}))}loadImage(){return new Promise(((t,e)=>{const r=this._options,n=new Image;if(!r.image)return e("Image is not defined");"string"===typeof r.imageOptions.crossOrigin&&(n.crossOrigin=r.imageOptions.crossOrigin),this._image=n,n.onload=()=>{t()},n.src=r.image}))}async drawImage({width:t,height:e,count:r,dotSize:n}){const i=this._options,s=Math.floor((i.width-r*n)/2),o=Math.floor((i.height-r*n)/2),a=s+i.imageOptions.margin+(r*n-t)/2,h=o+i.imageOptions.margin+(r*n-e)/2,c=t-2*i.imageOptions.margin,l=e-2*i.imageOptions.margin,u=document.createElementNS("http://www.w3.org/2000/svg","image");u.setAttribute("x",String(a)),u.setAttribute("y",String(h)),u.setAttribute("width",`${c}px`),u.setAttribute("height",`${l}px`);const d=await Le(i.image||"");u.setAttribute("href",d||""),this._element.appendChild(u)}_createColor({options:t,color:e,additionalRotation:r,x:n,y:i,height:s,width:o,name:a}){const h=o>s?o:s,c=document.createElementNS("http://www.w3.org/2000/svg","rect");if(c.setAttribute("x",String(n)),c.setAttribute("y",String(i)),c.setAttribute("height",String(s)),c.setAttribute("width",String(o)),c.setAttribute("clip-path",`url('#clip-path-${a}')`),t){let e;if(t.type===He.radial)e=document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),e.setAttribute("id",a),e.setAttribute("gradientUnits","userSpaceOnUse"),e.setAttribute("fx",String(n+o/2)),e.setAttribute("fy",String(i+s/2)),e.setAttribute("cx",String(n+o/2)),e.setAttribute("cy",String(i+s/2)),e.setAttribute("r",String(h/2));else{const h=((t.rotation||0)+r)%(2*Math.PI),c=(h+2*Math.PI)%(2*Math.PI);let l=n+o/2,u=i+s/2,d=n+o/2,f=i+s/2;c>=0&&c<=.25*Math.PI||c>1.75*Math.PI&&c<=2*Math.PI?(l-=o/2,u-=s/2*Math.tan(h),d+=o/2,f+=s/2*Math.tan(h)):c>.25*Math.PI&&c<=.75*Math.PI?(u-=s/2,l-=o/2/Math.tan(h),f+=s/2,d+=o/2/Math.tan(h)):c>.75*Math.PI&&c<=1.25*Math.PI?(l+=o/2,u+=s/2*Math.tan(h),d-=o/2,f-=s/2*Math.tan(h)):c>1.25*Math.PI&&c<=1.75*Math.PI&&(u+=s/2,l+=o/2/Math.tan(h),f-=s/2,d-=o/2/Math.tan(h)),e=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),e.setAttribute("id",a),e.setAttribute("gradientUnits","userSpaceOnUse"),e.setAttribute("x1",String(Math.round(l))),e.setAttribute("y1",String(Math.round(u))),e.setAttribute("x2",String(Math.round(d))),e.setAttribute("y2",String(Math.round(f)))}t.colorStops.forEach((({offset:t,color:r})=>{const n=document.createElementNS("http://www.w3.org/2000/svg","stop");n.setAttribute("offset",100*t+"%"),n.setAttribute("stop-color",r),e.appendChild(n)})),c.setAttribute("fill",`url('#${a}')`),this._defs.appendChild(e)}else e&&c.setAttribute("fill",e);this._element.appendChild(c)}}var Xe={canvas:"canvas",svg:"svg"};const Ge={};for(let ji=0;ji<=40;ji++)Ge[ji]=ji;var Ze=Ge,tr={L:"L",M:"M",Q:"Q",H:"H"};const er={type:Xe.canvas,shape:Ye.square,width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:Ze[0],mode:void 0,errorCorrectionLevel:tr.Q},imageOptions:{saveAsBlob:!1,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000"},backgroundOptions:{round:0,color:"#fff"}};var rr=er;function nr(t){const e={...t};if(!e.colorStops||!e.colorStops.length)throw"Field 'colorStops' is required in gradient";return e.rotation?e.rotation=Number(e.rotation):e.rotation=0,e.colorStops=e.colorStops.map((t=>({...t,offset:Number(t.offset)}))),e}function ir(t){const e={...t};return e.width=Number(e.width),e.height=Number(e.height),e.margin=Number(e.margin),e.imageOptions={...e.imageOptions,hideBackgroundDots:Boolean(e.imageOptions.hideBackgroundDots),imageSize:Number(e.imageOptions.imageSize),margin:Number(e.imageOptions.margin)},e.margin>Math.min(e.width,e.height)&&(e.margin=Math.min(e.width,e.height)),e.dotsOptions={...e.dotsOptions},e.dotsOptions.gradient&&(e.dotsOptions.gradient=nr(e.dotsOptions.gradient)),e.cornersSquareOptions&&(e.cornersSquareOptions={...e.cornersSquareOptions},e.cornersSquareOptions.gradient&&(e.cornersSquareOptions.gradient=nr(e.cornersSquareOptions.gradient))),e.cornersDotOptions&&(e.cornersDotOptions={...e.cornersDotOptions},e.cornersDotOptions.gradient&&(e.cornersDotOptions.gradient=nr(e.cornersDotOptions.gradient))),e.backgroundOptions&&(e.backgroundOptions={...e.backgroundOptions},e.backgroundOptions.gradient&&(e.backgroundOptions.gradient=nr(e.backgroundOptions.gradient))),e}var sr=r(49873),or=r.n(sr);class ar{constructor(t){this._options=t?ir(Pe(rr,t)):rr,this.update()}static _clearContainer(t){t&&(t.innerHTML="")}_setupSvg(){if(!this._qr)return;const t=new Qe(this._options);this._svg=t.getElement(),this._svgDrawingPromise=t.drawQR(this._qr).then((()=>{this._svg&&this._extension?.(t.getElement(),this._options)}))}_setupCanvas(){this._qr&&(this._canvas=document.createElement("canvas"),this._canvas.width=this._options.width,this._canvas.height=this._options.height,this._setupSvg(),this._canvasDrawingPromise=this._svgDrawingPromise?.then((()=>{if(!this._svg)return;const t=this._svg,e=(new XMLSerializer).serializeToString(t),r=btoa(e),n="data:image/svg+xml;base64,"+r,i=new Image;return new Promise((t=>{i.onload=()=>{this._canvas?.getContext("2d")?.drawImage(i,0,0),t()},i.src=n}))})))}async _getElement(t="png"){if(!this._qr)throw"QR code is empty";return"svg"===t.toLowerCase()?(this._svg&&this._svgDrawingPromise||this._setupSvg(),await this._svgDrawingPromise,this._svg):(this._canvas&&this._canvasDrawingPromise||this._setupCanvas(),await this._canvasDrawingPromise,this._canvas)}update(t){ar._clearContainer(this._container),this._options=t?ir(Pe(this._options,t)):this._options,this._options.data&&(this._qr=or()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||qe(this._options.data)),this._qr.make(),this._options.type===Xe.canvas?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(t){if(t){if("function"!==typeof t.appendChild)throw"Container should be a single DOM node";this._options.type===Xe.canvas?this._canvas&&t.appendChild(this._canvas):this._svg&&t.appendChild(this._svg),this._container=t}}applyExtension(t){if(!t)throw"Extension function should be defined.";this._extension=t,this.update()}deleteExtension(){this._extension=void 0,this.update()}async getRawData(t="png"){if(!this._qr)throw"QR code is empty";const e=await this._getElement(t);if(!e)return null;if("svg"===t.toLowerCase()){const t=new XMLSerializer,r=t.serializeToString(e);return new Blob(['<?xml version="1.0" standalone="no"?>\r\n'+r],{type:"image/svg+xml"})}return new Promise((r=>e.toBlob(r,`image/${t}`,1)))}async download(t){if(!this._qr)throw"QR code is empty";let e="png",r="qr";"string"===typeof t?(e=t,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):"object"===typeof t&&null!==t&&(t.name&&(r=t.name),t.extension&&(e=t.extension));const n=await this._getElement(e);if(n)if("svg"===e.toLowerCase()){const t=new XMLSerializer;let e=t.serializeToString(n);e='<?xml version="1.0" standalone="no"?>\r\n'+e;const i="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e);De(i,`${r}.svg`)}else{const t=n.toDataURL(`image/${e}`);De(t,`${r}.${e}`)}}}var hr,cr=ar,lr=r(98916),ur=new Uint8Array(16);function dr(){if(!hr&&(hr="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!hr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return hr(ur)}for(var fr=[],pr=0;pr<256;++pr)fr.push((pr+256).toString(16).slice(1));function gr(t,e=0){return(fr[t[e+0]]+fr[t[e+1]]+fr[t[e+2]]+fr[t[e+3]]+"-"+fr[t[e+4]]+fr[t[e+5]]+"-"+fr[t[e+6]]+fr[t[e+7]]+"-"+fr[t[e+8]]+fr[t[e+9]]+"-"+fr[t[e+10]]+fr[t[e+11]]+fr[t[e+12]]+fr[t[e+13]]+fr[t[e+14]]+fr[t[e+15]]).toLowerCase()}var yr=null,wr=null,mr=0;function br(t,e,r){t=t||{};var n=e&&r||0,i=e||new Uint8Array(16),s=t.random||(t.rng||dr)(),o=void 0!==t.msecs?t.msecs:Date.now(),a=void 0!==t.seq?t.seq:null,h=wr,c=yr;return o>mr&&void 0===t.msecs&&(mr=o,null!==a&&(h=null,c=null)),null!==a&&(a>2147483647&&(a=2147483647),h=a>>>19&4095,c=524287&a),null!==h&&null!==c||(h=127&s[6],h=h<<8|s[7],c=63&s[8],c=c<<8|s[9],c=c<<5|s[10]>>>3),o+1e4>mr&&null===a?++c>524287&&(c=0,++h>4095&&(h=0,mr++)):mr=o,wr=h,yr=c,i[n++]=mr/1099511627776&255,i[n++]=mr/4294967296&255,i[n++]=mr/16777216&255,i[n++]=mr/65536&255,i[n++]=mr/256&255,i[n++]=255&mr,i[n++]=h>>>4&15|112,i[n++]=255&h,i[n++]=c>>>13&63|128,i[n++]=c>>>5&255,i[n++]=c<<3&255|7&s[10],i[n++]=s[11],i[n++]=s[12],i[n++]=s[13],i[n++]=s[14],i[n++]=s[15],e||gr(i)}var _r=br;const vr="Request id is required",Ar="Request in process",kr="Not authenticated",Er="Origin is required",xr={width:500,height:500,type:"svg",data:"liquid://",margin:25,imageOptions:{hideBackgroundDots:!0,imageSize:.4,margin:15},dotsOptions:{type:"extra-rounded",gradient:{type:"radial",rotation:0,colorStops:[{offset:0,color:"#9966ff"},{offset:1,color:"#332257"}]}},backgroundOptions:{color:"#ffffff",gradient:null},image:"https://algorandtechnologies.com/assets/media-kit/logos/logo-marks/png/algorand_logo_mark_black.png",cornersSquareOptions:{color:"#000000",gradient:{type:"linear",rotation:0,colorStops:[{offset:0,color:"#332257"},{offset:1,color:"#040908"}]}},cornersDotOptions:{type:"dot",color:"#000000",gradient:{type:"linear",rotation:0,colorStops:[{offset:0,color:"#000000"},{offset:1,color:"#000000"}]}}};async function Cr({requestId:t,url:e},r=xr){if("undefined"===typeof t)throw new Error(vr);r.data=Sr(e,t);const n=new cr(r);return n.getRawData("png").then((t=>{if(!t)throw new TypeError("Could not get qrcode blob");return URL.createObjectURL(t)}))}function Sr(t,e){if("string"!==typeof t)throw new Error(Er);if("string"!==typeof e)throw new Error(vr);return`liquid://${t.replace("https://","")}/?requestId=${e}`}class Or extends lr{url;type;authenticated=!1;requestId;peerClient;qrCodeOptions=xr;socket;constructor(t,e={autoConnect:!0}){super(),this.url=t,this.socket=Be(t,e),globalThis.socket=this.socket,this.socket.on("connect",(()=>{this.emit("connect",this.socket.id)})),this.socket.on("disconnect",(()=>{this.emit("disconnect",this.socket.id)}))}static generateRequestId(){return _r()}attestation(t,e=N){return z(this.url,t,e).then((()=>{this.authenticated=!0})).catch((t=>{throw this.authenticated=!1,t}))}assertion(){}async qrCode(){if("undefined"===typeof this.requestId)throw new Error(vr);return Cr({requestId:this.requestId,url:this.url},this.qrCodeOptions)}deepLink(t){if("string"!==typeof t&&"undefined"===typeof this.requestId)throw new Error(vr);return Sr(this.url,t||this.requestId)}async peer(t,e,r={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10}){if("undefined"!==typeof this.requestId)throw new Error(Ar);return new Promise((async n=>{let i=[];if(this.peerClient=new RTCPeerConnection(r),globalThis.peerClient=this.peerClient,this.type="offer"===e?"answer":"offer","offer"===e&&await this.link(t),this.peerClient.onicecandidate=t=>{t.candidate&&(this.emit(`${this.type}-candidate`,t.candidate.toJSON()),this.socket.emit(`${this.type}-candidate`,t.candidate.toJSON()))},this.socket.on(`${e}-candidate`,(async t=>{this.peerClient.remoteDescription&&this.peerClient.remoteDescription?(this.emit(`${e}-candidate`,t),await this.peerClient.addIceCandidate(new RTCIceCandidate(t))):i.push(t)})),this.peerClient.ondatachannel=t=>{globalThis.dc=t.channel,this.emit("data-channel",t.channel),n(t.channel)},"offer"===e){const t=await this.signal(e);await this.peerClient.setRemoteDescription(t);const r=await this.peerClient.createAnswer();await this.peerClient.setLocalDescription(r),i.length>0&&(await Promise.all(i.map((async t=>{this.emit(`${e}-candidate`,t),await this.peerClient.addIceCandidate(new RTCIceCandidate(t))}))),i=[]),this.emit(`${this.type}-description`,r.sdp),this.socket.emit(`${this.type}-description`,r.sdp)}else{const t=this.peerClient.createDataChannel("liquid"),r=await this.peerClient.createOffer();await this.peerClient.setLocalDescription(r),this.socket.emit(`${this.type}-description`,r.sdp),this.emit(`${this.type}-description`,r.sdp);const s=await this.signal(e);await this.peerClient.setRemoteDescription(s),i.length>0&&(await Promise.all(i.map((async t=>{this.emit(`${e}-candidate`,t),await this.peerClient.addIceCandidate(new RTCIceCandidate(t))}))),i=[]),this.emit("data-channel",t),n(t)}}))}async link(t){if("undefined"!==typeof this.requestId)throw new Error(Ar);return this.requestId=t,this.emit("link",{requestId:t}),new Promise((e=>{this.socket.emit("link",{requestId:t},(({data:t})=>{this.authenticated=!0,delete this.requestId,this.emit("link-message",t),e(t)}))}))}async signal(t){if(!this.authenticated)throw new Error(kr);return this.emit("signal",{type:t}),new Promise((e=>{this.socket.once(`${t}-description`,(r=>{const n={type:t,sdp:r};this.emit(`${t}-description`,n),e(n)}))}))}close(t=!1){this.socket.removeAllListeners(),delete this.requestId,this.authenticated=!1,t&&this.socket.disconnect(),this.emit("close")}}let Mr,Rr,Br;try{Mr=new TextDecoder}catch($i){}let Tr=0;const qr=[],Ir=105,Pr=57342,Dr=57343,Nr=57337,Lr=6,Ur={};let $r,jr,zr,Fr,Vr,Kr,Hr,Yr=11281e4,Jr=1681e4,Wr=qr,Qr=0,Xr={},Gr=0,Zr=0,tn=[],en=[],rn={useRecords:!1,mapsAsObjects:!0},nn=!1,sn=2;try{new Function("")}catch($i){sn=1/0}class on{constructor(t){if(t&&(!t.keyMap&&!t._keyMap||t.useRecords||(t.useRecords=!1,t.mapsAsObjects=!0),!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.getStructures&&(t.getShared=t.getStructures),t.getShared&&!t.structures&&((t.structures=[]).uninitialized=!0),t.keyMap)){this.mapKey=new Map;for(let[e,r]of Object.entries(t.keyMap))this.mapKey.set(r,e)}Object.assign(this,t)}decodeKey(t){return this.keyMap&&this.mapKey.get(t)||t}encodeKey(t){return this.keyMap&&this.keyMap.hasOwnProperty(t)?this.keyMap[t]:t}encodeKeys(t){if(!this._keyMap)return t;let e=new Map;for(let[r,n]of Object.entries(t))e.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,n);return e}decodeKeys(t){if(!this._keyMap||"Map"!=t.constructor.name)return t;if(!this._mapKey){this._mapKey=new Map;for(let[t,e]of Object.entries(this._keyMap))this._mapKey.set(e,t)}let e={};return t.forEach(((t,r)=>e[un(this._mapKey.has(r)?this._mapKey.get(r):r)]=t)),e}mapDecode(t,e){let r=this.decode(t);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map((t=>this.decodeKeys(t)))}return r}decode(t,e){if(Rr)return Pn((()=>(Dn(),this?this.decode(t,e):on.prototype.decode.call(rn,t,e))));Br=e>-1?e:t.length,Tr=0,Qr=0,Zr=0,jr=null,Wr=qr,zr=null,Rr=t;try{Kr=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch($i){if(Rr=null,t instanceof Uint8Array)throw $i;throw new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof on){if(Xr=this,Vr=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return $r=this.structures,an();(!$r||$r.length>0)&&($r=[])}else Xr=rn,(!$r||$r.length>0)&&($r=[]),Vr=null;return an()}decodeMultiple(t,e){let r,n=0;try{let i=t.length;nn=!0;let s=this?this.decode(t,i):Ln.decode(t,i);if(!e){r=[s];while(Tr<i)n=Tr,r.push(an());return r}if(!1===e(s))return;while(Tr<i)if(n=Tr,!1===e(an()))return}catch($i){throw $i.lastPosition=n,$i.values=r,$i}finally{nn=!1,Dn()}}}function an(){try{let t=hn();if(zr){if(Tr>=zr.postBundlePosition){let t=new Error("Unexpected bundle position");throw t.incomplete=!0,t}Tr=zr.postBundlePosition,zr=null}if(Tr==Br)$r=null,Rr=null,Fr&&(Fr=null);else{if(Tr>Br){let t=new Error("Unexpected end of CBOR data");throw t.incomplete=!0,t}if(!nn)throw new Error("Data read, but end of buffer not reached")}return t}catch($i){throw Dn(),($i instanceof RangeError||$i.message.startsWith("Unexpected end of buffer"))&&($i.incomplete=!0),$i}}function hn(){let t=Rr[Tr++],e=t>>5;if(t&=31,t>23)switch(t){case 24:t=Rr[Tr++];break;case 25:if(7==e)return _n();t=Kr.getUint16(Tr),Tr+=2;break;case 26:if(7==e){let t=Kr.getFloat32(Tr);if(Xr.useFloat32>2){let e=Nn[(127&Rr[Tr])<<1|Rr[Tr+1]>>7];return Tr+=4,(e*t+(t>0?.5:-.5)|0)/e}return Tr+=4,t}t=Kr.getUint32(Tr),Tr+=4;break;case 27:if(7==e){let t=Kr.getFloat64(Tr);return Tr+=8,t}if(e>1){if(Kr.getUint32(Tr)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=Kr.getUint32(Tr+4)}else Xr.int64AsNumber?(t=4294967296*Kr.getUint32(Tr),t+=Kr.getUint32(Tr+4)):t=Kr.getBigUint64(Tr);Tr+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let t,r=[],n=0;while((t=hn())!=Ur){if(n>=Yr)throw new Error(`Array length exceeds ${Yr}`);r[n++]=t}return 4==e?r:3==e?r.join(""):Buffer.concat(r);case 5:let i;if(Xr.mapsAsObjects){let t={},e=0;if(Xr.keyMap)while((i=hn())!=Ur){if(e++>=Jr)throw new Error(`Property count exceeds ${Jr}`);t[un(Xr.decodeKey(i))]=hn()}else while((i=hn())!=Ur){if(e++>=Jr)throw new Error(`Property count exceeds ${Jr}`);t[un(i)]=hn()}return t}{Hr&&(Xr.mapsAsObjects=!0,Hr=!1);let t=new Map;if(Xr.keyMap){let e=0;while((i=hn())!=Ur){if(e++>=Jr)throw new Error(`Map size exceeds ${Jr}`);t.set(Xr.decodeKey(i),hn())}}else{let e=0;while((i=hn())!=Ur){if(e++>=Jr)throw new Error(`Map size exceeds ${Jr}`);t.set(i,hn())}}return t}case 7:return Ur;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return wn(t);case 3:if(Zr>=Tr)return jr.slice(Tr-Gr,(Tr+=t)-Gr);if(0==Zr&&Br<140&&t<32){let e=t<16?yn(t):gn(t);if(null!=e)return e}return dn(t);case 4:if(t>=Yr)throw new Error(`Array length exceeds ${Yr}`);let e=new Array(t);for(let n=0;n<t;n++)e[n]=hn();return e;case 5:if(t>=Jr)throw new Error(`Map size exceeds ${Yr}`);if(Xr.mapsAsObjects){let e={};if(Xr.keyMap)for(let r=0;r<t;r++)e[un(Xr.decodeKey(hn()))]=hn();else for(let r=0;r<t;r++)e[un(hn())]=hn();return e}{Hr&&(Xr.mapsAsObjects=!0,Hr=!1);let e=new Map;if(Xr.keyMap)for(let r=0;r<t;r++)e.set(Xr.decodeKey(hn()),hn());else for(let r=0;r<t;r++)e.set(hn(),hn());return e}case 6:if(t>=Nr){let e=$r[8191&t];if(e)return e.read||(e.read=ln(e)),e.read();if(t<65536){if(t==Dr){let t=qn(),e=hn(),r=hn();An(e,r);let n={};if(Xr.keyMap)for(let i=2;i<t;i++){let t=Xr.decodeKey(r[i-2]);n[un(t)]=hn()}else for(let i=2;i<t;i++){let t=r[i-2];n[un(t)]=hn()}return n}if(t==Pr){let t=qn(),e=hn();for(let r=2;r<t;r++)An(e++,hn());return hn()}if(t==Nr)return Tn();if(Xr.getShared&&(In(),e=$r[8191&t],e))return e.read||(e.read=ln(e)),e.read()}}let r=tn[t];if(r)return r.handlesRead?r(hn):r(hn());{let e=hn();for(let r=0;r<en.length;r++){let n=en[r](t,e);if(void 0!==n)return n}return new vn(e,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let e=(Vr||Cn())[t];if(void 0!==e)return e;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let t=new Error("Unexpected end of CBOR data");throw t.incomplete=!0,t}throw new Error("Unknown CBOR token "+t)}}const cn=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function ln(t){if(!t)throw new Error("Structure is required in record definition");function e(){let t=Rr[Tr++];if(t&=31,t>23)switch(t){case 24:t=Rr[Tr++];break;case 25:t=Kr.getUint16(Tr),Tr+=2;break;case 26:t=Kr.getUint32(Tr),Tr+=4;break;default:throw new Error("Expected array header, but got "+Rr[Tr-1])}let e=this.compiledReader;while(e){if(e.propertyCount===t)return e(hn);e=e.next}if(this.slowReads++>=sn){let r=this.length==t?this:this.slice(0,t);return e=Xr.keyMap?new Function("r","return {"+r.map((t=>Xr.decodeKey(t))).map((t=>cn.test(t)?un(t)+":r()":"["+JSON.stringify(t)+"]:r()")).join(",")+"}"):new Function("r","return {"+r.map((t=>cn.test(t)?un(t)+":r()":"["+JSON.stringify(t)+"]:r()")).join(",")+"}"),this.compiledReader&&(e.next=this.compiledReader),e.propertyCount=t,this.compiledReader=e,e(hn)}let r={};if(Xr.keyMap)for(let n=0;n<t;n++)r[un(Xr.decodeKey(this[n]))]=hn();else for(let n=0;n<t;n++)r[un(this[n])]=hn();return r}return t.slowReads=0,e}function un(t){if("string"===typeof t)return"__proto__"===t?"__proto_":t;if("number"===typeof t||"boolean"===typeof t||"bigint"===typeof t)return t.toString();if(null==t)return t+"";throw new Error("Invalid property name type "+typeof t)}let dn=fn;function fn(t){let e;if(t<16&&(e=yn(t)))return e;if(t>64&&Mr)return Mr.decode(Rr.subarray(Tr,Tr+=t));const r=Tr+t,n=[];e="";while(Tr<r){const t=Rr[Tr++];if(0===(128&t))n.push(t);else if(192===(224&t)){const e=63&Rr[Tr++];n.push((31&t)<<6|e)}else if(224===(240&t)){const e=63&Rr[Tr++],r=63&Rr[Tr++];n.push((31&t)<<12|e<<6|r)}else if(240===(248&t)){const e=63&Rr[Tr++],r=63&Rr[Tr++],i=63&Rr[Tr++];let s=(7&t)<<18|e<<12|r<<6|i;s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s)}else n.push(t);n.length>=4096&&(e+=pn.apply(String,n),n.length=0)}return n.length>0&&(e+=pn.apply(String,n)),e}let pn=String.fromCharCode;function gn(t){let e=Tr,r=new Array(t);for(let n=0;n<t;n++){const t=Rr[Tr++];if((128&t)>0)return void(Tr=e);r[n]=t}return pn.apply(String,r)}function yn(t){if(t<4){if(t<2){if(0===t)return"";{let t=Rr[Tr++];return(128&t)>1?void(Tr-=1):pn(t)}}{let e=Rr[Tr++],r=Rr[Tr++];if((128&e)>0||(128&r)>0)return void(Tr-=2);if(t<3)return pn(e,r);let n=Rr[Tr++];return(128&n)>0?void(Tr-=3):pn(e,r,n)}}{let e=Rr[Tr++],r=Rr[Tr++],n=Rr[Tr++],i=Rr[Tr++];if((128&e)>0||(128&r)>0||(128&n)>0||(128&i)>0)return void(Tr-=4);if(t<6){if(4===t)return pn(e,r,n,i);{let t=Rr[Tr++];return(128&t)>0?void(Tr-=5):pn(e,r,n,i,t)}}if(t<8){let s=Rr[Tr++],o=Rr[Tr++];if((128&s)>0||(128&o)>0)return void(Tr-=6);if(t<7)return pn(e,r,n,i,s,o);let a=Rr[Tr++];return(128&a)>0?void(Tr-=7):pn(e,r,n,i,s,o,a)}{let s=Rr[Tr++],o=Rr[Tr++],a=Rr[Tr++],h=Rr[Tr++];if((128&s)>0||(128&o)>0||(128&a)>0||(128&h)>0)return void(Tr-=8);if(t<10){if(8===t)return pn(e,r,n,i,s,o,a,h);{let t=Rr[Tr++];return(128&t)>0?void(Tr-=9):pn(e,r,n,i,s,o,a,h,t)}}if(t<12){let c=Rr[Tr++],l=Rr[Tr++];if((128&c)>0||(128&l)>0)return void(Tr-=10);if(t<11)return pn(e,r,n,i,s,o,a,h,c,l);let u=Rr[Tr++];return(128&u)>0?void(Tr-=11):pn(e,r,n,i,s,o,a,h,c,l,u)}{let c=Rr[Tr++],l=Rr[Tr++],u=Rr[Tr++],d=Rr[Tr++];if((128&c)>0||(128&l)>0||(128&u)>0||(128&d)>0)return void(Tr-=12);if(t<14){if(12===t)return pn(e,r,n,i,s,o,a,h,c,l,u,d);{let t=Rr[Tr++];return(128&t)>0?void(Tr-=13):pn(e,r,n,i,s,o,a,h,c,l,u,d,t)}}{let f=Rr[Tr++],p=Rr[Tr++];if((128&f)>0||(128&p)>0)return void(Tr-=14);if(t<15)return pn(e,r,n,i,s,o,a,h,c,l,u,d,f,p);let g=Rr[Tr++];return(128&g)>0?void(Tr-=15):pn(e,r,n,i,s,o,a,h,c,l,u,d,f,p,g)}}}}}function wn(t){return Xr.copyBuffers?Uint8Array.prototype.slice.call(Rr,Tr,Tr+=t):Rr.subarray(Tr,Tr+=t)}let mn=new Float32Array(1),bn=new Uint8Array(mn.buffer,0,4);function _n(){let t=Rr[Tr++],e=Rr[Tr++],r=(127&t)>>2;if(31===r)return e||3&t?NaN:128&t?-1/0:1/0;if(0===r){let r=((3&t)<<8|e)/(1<<24);return 128&t?-r:r}return bn[3]=128&t|56+(r>>1),bn[2]=(7&t)<<5|e>>3,bn[1]=e<<5,bn[0]=0,mn[0]}new Array(4096);class vn{constructor(t,e){this.value=t,this.tag=e}}tn[0]=t=>new Date(t),tn[1]=t=>new Date(Math.round(1e3*t)),tn[2]=t=>{let e=BigInt(0);for(let r=0,n=t.byteLength;r<n;r++)e=BigInt(t[r])+(e<<BigInt(8));return e},tn[3]=t=>BigInt(-1)-tn[2](t),tn[4]=t=>+(t[1]+"e"+t[0]),tn[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));const An=(t,e)=>{t-=57344;let r=$r[t];r&&r.isShared&&(($r.restoreStructures||($r.restoreStructures=[]))[t]=r),$r[t]=e,e.read=ln(e)};tn[Ir]=t=>{let e=t.length,r=t[1];An(t[0],r);let n={};for(let i=2;i<e;i++){let e=r[i-2];n[un(e)]=t[i]}return n},tn[14]=t=>zr?zr[0].slice(zr.position0,zr.position0+=t):new vn(t,14),tn[15]=t=>zr?zr[1].slice(zr.position1,zr.position1+=t):new vn(t,15);let kn={Error:Error,RegExp:RegExp};tn[27]=t=>(kn[t[0]]||Error)(t[1],t[2]);const En=t=>{if(132!=Rr[Tr++]){let t=new Error("Packed values structure must be followed by a 4 element array");throw Rr.length<Tr&&(t.incomplete=!0),t}let e=t();if(!e||!e.length){let t=new Error("Packed values structure must be followed by a 4 element array");throw t.incomplete=!0,t}return Vr=Vr?e.concat(Vr.slice(e.length)):e,Vr.prefixes=t(),Vr.suffixes=t(),t()};function xn(t,e){return"string"===typeof t?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function Cn(){if(!Vr){if(!Xr.getShared)throw new Error("No packed values available");In()}return Vr}En.handlesRead=!0,tn[51]=En,tn[Lr]=t=>{if(!Vr){if(!Xr.getShared)return new vn(t,Lr);In()}if("number"==typeof t)return Vr[16+(t>=0?2*t:-2*t-1)];let e=new Error("No support for non-integer packed references yet");throw void 0===t&&(e.incomplete=!0),e},tn[28]=t=>{Fr||(Fr=new Map,Fr.id=0);let e,r=Fr.id++,n=Tr,i=Rr[Tr];e=i>>5==4?[]:{};let s={target:e};Fr.set(r,s);let o=t();return s.used?(Object.getPrototypeOf(e)!==Object.getPrototypeOf(o)&&(Tr=n,e=o,Fr.set(r,{target:e}),o=t()),Object.assign(e,o)):(s.target=o,o)},tn[28].handlesRead=!0,tn[29]=t=>{let e=Fr.get(t);return e.used=!0,e.target},tn[258]=t=>new Set(t),(tn[259]=t=>(Xr.mapsAsObjects&&(Xr.mapsAsObjects=!1,Hr=!0),t())).handlesRead=!0;const Sn=1399353956;en.push(((t,e)=>t>=225&&t<=255?xn(Cn().prefixes[t-224],e):t>=28704&&t<=32767?xn(Cn().prefixes[t-28672],e):t>=1879052288&&t<=2147483647?xn(Cn().prefixes[t-1879048192],e):t>=216&&t<=223?xn(e,Cn().suffixes[t-216]):t>=27647&&t<=28671?xn(e,Cn().suffixes[t-27639]):t>=1811940352&&t<=1879048191?xn(e,Cn().suffixes[t-1811939328]):t==Sn?{packedValues:Vr,structures:$r.slice(0),version:e}:55799==t?e:void 0));const On=1==new Uint8Array(new Uint16Array([1]).buffer)[0],Mn=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,"undefined"==typeof BigUint64Array?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,"undefined"==typeof BigInt64Array?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],Rn=[64,68,69,70,71,72,77,78,79,85,86];for(let ji=0;ji<Mn.length;ji++)Bn(Mn[ji],Rn[ji]);function Bn(t,e){let r,n="get"+t.name.slice(0,-5);"function"===typeof t?r=t.BYTES_PER_ELEMENT:t=null;for(let i=0;i<2;i++){if(!i&&1==r)continue;let s=2==r?1:4==r?2:8==r?3:0;tn[i?e:e-4]=1==r||i==On?n=>{if(!t)throw new Error("Could not find typed array for code "+e);return Xr.copyBuffers||1!==r&&(2!==r||1&n.byteOffset)&&(4!==r||3&n.byteOffset)&&(8!==r||7&n.byteOffset)?new t(Uint8Array.prototype.slice.call(n,0).buffer):new t(n.buffer,n.byteOffset,n.byteLength>>s)}:r=>{if(!t)throw new Error("Could not find typed array for code "+e);let o=new DataView(r.buffer,r.byteOffset,r.byteLength),a=r.length>>s,h=new t(a),c=o[n];for(let t=0;t<a;t++)h[t]=c.call(o,t<<s,i);return h}}}function Tn(){let t=qn(),e=Tr+hn();for(let n=2;n<t;n++){let t=qn();Tr+=t}let r=Tr;return Tr=e,zr=[fn(qn()),fn(qn())],zr.position0=0,zr.position1=0,zr.postBundlePosition=Tr,Tr=r,hn()}function qn(){let t=31&Rr[Tr++];if(t>23)switch(t){case 24:t=Rr[Tr++];break;case 25:t=Kr.getUint16(Tr),Tr+=2;break;case 26:t=Kr.getUint32(Tr),Tr+=4;break}return t}function In(){if(Xr.getShared){let t=Pn((()=>(Rr=null,Xr.getShared())))||{},e=t.structures||[];Xr.sharedVersion=t.version,Vr=Xr.sharedValues=t.packedValues,!0===$r?Xr.structures=$r=e:$r.splice.apply($r,[0,e.length].concat(e))}}function Pn(t){let e=Br,r=Tr,n=Qr,i=Gr,s=Zr,o=jr,a=Wr,h=Fr,c=zr,l=new Uint8Array(Rr.slice(0,Br)),u=$r,d=Xr,f=nn,p=t();return Br=e,Tr=r,Qr=n,Gr=i,Zr=s,jr=o,Wr=a,Fr=h,zr=c,Rr=l,nn=f,$r=u,Xr=d,Kr=new DataView(Rr.buffer,Rr.byteOffset,Rr.byteLength),p}function Dn(){Rr=null,Fr=null,$r=null}const Nn=new Array(147);for(let ji=0;ji<256;ji++)Nn[ji]=+("1e"+Math.floor(45.15-.30103*ji));let Ln=new on({useRecords:!1});const Un=Ln.decode,$n=(Ln.decodeMultiple,{NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4});let jn,zn,Fn;try{jn=new TextEncoder}catch($i){}const Vn="object"===typeof globalThis&&globalThis.Buffer,Kn="undefined"!==typeof Vn,Hn=Kn?Vn.allocUnsafeSlow:Uint8Array,Yn=Kn?Vn:Uint8Array,Jn=256,Wn=Kn?4294967296:2144337920;let Qn,Xn,Gn,Zn,ti=0,ei=null;const ri=61440,ni=/[\u0080-\uFFFF]/,ii=Symbol("record-id");class si extends on{constructor(t){let e,r,n,i,s;super(t),this.offset=0,t=t||{};let o=Yn.prototype.utf8Write?function(t,e,r){return Xn.utf8Write(t,e,r)}:!(!jn||!jn.encodeInto)&&function(t,e){return jn.encodeInto(t,Xn.subarray(e)).written},a=this,h=t.structures||t.saveStructures,c=t.maxSharedStructures;if(null==c&&(c=h?128:0),c>8190)throw new Error("Maximum maxSharedStructure is 8190");let l=t.sequential;l&&(c=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let u,d,f,p=t.sharedValues;if(p){f=Object.create(null);for(let t=0,e=p.length;t<e;t++)f[p[t]]=t}let g=[],y=0,w=0;this.mapEncode=function(t,e){if(this._keyMap&&!this._mapped)switch(t.constructor.name){case"Array":t=t.map((t=>this.encodeKeys(t)));break}return this.encode(t,e)},this.encode=function(o,h){if(Xn||(Xn=new Hn(8192),Gn=new DataView(Xn.buffer,0,8192),ti=0),Zn=Xn.length-10,Zn-ti<2048?(Xn=new Hn(Xn.length),Gn=new DataView(Xn.buffer,0,Xn.length),Zn=Xn.length-10,ti=0):h===ki&&(ti=ti+7&2147483640),e=ti,a.useSelfDescribedHeader&&(Gn.setUint32(ti,3654940416),ti+=3),s=a.structuredClone?new Map:null,a.bundleStrings&&"string"!==typeof o?(ei=[],ei.size=1/0):ei=null,r=a.structures,r){if(r.uninitialized){let t=a.getShared()||{};a.structures=r=t.structures||[],a.sharedVersion=t.version;let e=a.sharedValues=t.packedValues;if(e){f={};for(let t=0,r=e.length;t<r;t++)f[e[t]]=t}}let t=r.length;if(t>c&&!l&&(t=c),!r.transitions){r.transitions=Object.create(null);for(let e=0;e<t;e++){let t=r[e];if(!t)continue;let n,i=r.transitions;for(let r=0,s=t.length;r<s;r++){void 0===i[ii]&&(i[ii]=e);let s=t[r];n=i[s],n||(n=i[s]=Object.create(null)),i=n}i[ii]=1048576|e}}l||(r.nextId=t)}if(n&&(n=!1),i=r||[],d=f,t.pack){let e=new Map;if(e.values=[],e.encoder=a,e.maxValues=t.maxPrivatePackedValues||(f?16:1/0),e.objectMap=f||!1,e.samplingPackedValues=u,ui(o,e),e.values.length>0){Xn[ti++]=216,Xn[ti++]=51,hi(4);let t=e.values;m(t),hi(0),hi(0),d=Object.create(f||null);for(let e=0,r=t.length;e<r;e++)d[t[e]]=e}}Qn=h&xi;try{if(Qn)return;if(m(o),ei&&yi(e,m),a.offset=ti,s&&s.idsToInsert){ti+=2*s.idsToInsert.length,ti>Zn&&_(ti),a.offset=ti;let t=gi(Xn.subarray(e,ti),s.idsToInsert);return s=null,t}return h&ki?(Xn.start=e,Xn.end=ti,Xn):Xn.subarray(e,ti)}finally{if(r)if(w<10&&w++,r.length>c&&(r.length=c),y>1e4)r.transitions=null,w=0,y=0,g.length>0&&(g=[]);else if(g.length>0&&!l){for(let t=0,e=g.length;t<e;t++)g[t][ii]=void 0;g=[]}if(n&&a.saveShared){a.structures.length>c&&(a.structures=a.structures.slice(0,c));let t=Xn.subarray(e,ti);return!1===a.updateSharedData()?a.encode(o):t}h&Ei&&(ti=e)}},this.findCommonStringsToPack=()=>(u=new Map,f||(f=Object.create(null)),t=>{let e=t&&t.threshold||4,r=this.pack?t.maxPrivatePackedValues||16:0;p||(p=this.sharedValues=[]);for(let[i,s]of u)s.count>e&&(f[i]=r++,p.push(i),n=!0);while(this.saveShared&&!1===this.updateSharedData());u=null});const m=r=>{ti>Zn&&(Xn=_(ti));var n,i=typeof r;if("string"===i){if(d){let e=d[r];if(e>=0)return void(e<16?Xn[ti++]=e+224:(Xn[ti++]=198,m(1&e?15-e>>1:e-16>>1)));if(u&&!t.pack){let t=u.get(r);t?t.count++:u.set(r,{count:1})}}let i,s=r.length;if(ei&&s>=4&&s<1024){if((ei.size+=s)>ri){let t,r=(ei[0]?3*ei[0].length+ei[1].length:0)+10;ti+r>Zn&&(Xn=_(ti+r)),Xn[ti++]=217,Xn[ti++]=223,Xn[ti++]=249,Xn[ti++]=ei.position?132:130,Xn[ti++]=26,t=ti-e,ti+=4,ei.position&&yi(e,m),ei=["",""],ei.size=0,ei.position=t}let t=ni.test(r);return ei[t?0:1]+=r,Xn[ti++]=t?206:207,void m(s)}i=s<32?1:s<256?2:s<65536?3:5;let a=3*s;if(ti+a>Zn&&(Xn=_(ti+a)),s<64||!o){let t,e,o,a=ti+i;for(t=0;t<s;t++)e=r.charCodeAt(t),e<128?Xn[a++]=e:e<2048?(Xn[a++]=e>>6|192,Xn[a++]=63&e|128):55296===(64512&e)&&56320===(64512&(o=r.charCodeAt(t+1)))?(e=65536+((1023&e)<<10)+(1023&o),t++,Xn[a++]=e>>18|240,Xn[a++]=e>>12&63|128,Xn[a++]=e>>6&63|128,Xn[a++]=63&e|128):(Xn[a++]=e>>12|224,Xn[a++]=e>>6&63|128,Xn[a++]=63&e|128);n=a-ti-i}else n=o(r,ti+i,a);n<24?Xn[ti++]=96|n:n<256?(i<2&&Xn.copyWithin(ti+2,ti+1,ti+1+n),Xn[ti++]=120,Xn[ti++]=n):n<65536?(i<3&&Xn.copyWithin(ti+3,ti+2,ti+2+n),Xn[ti++]=121,Xn[ti++]=n>>8,Xn[ti++]=255&n):(i<5&&Xn.copyWithin(ti+5,ti+3,ti+3+n),Xn[ti++]=122,Gn.setUint32(ti,n),ti+=4),ti+=n}else if("number"===i)if(this.alwaysUseFloat||r>>>0!==r)if(this.alwaysUseFloat||(r|0)!==r){let t;if((t=this.useFloat32)>0&&r<4294967296&&r>=-2147483648){let e;if(Xn[ti++]=250,Gn.setFloat32(ti,r),t<4||((e=r*Nn[(127&Xn[ti])<<1|Xn[ti+1]>>7])|0)===e)return void(ti+=4);ti--}Xn[ti++]=251,Gn.setFloat64(ti,r),ti+=8}else r>=-24?Xn[ti++]=31-r:r>=-256?(Xn[ti++]=56,Xn[ti++]=~r):r>=-65536?(Xn[ti++]=57,Gn.setUint16(ti,~r),ti+=2):(Xn[ti++]=58,Gn.setUint32(ti,~r),ti+=4);else r<24?Xn[ti++]=r:r<256?(Xn[ti++]=24,Xn[ti++]=r):r<65536?(Xn[ti++]=25,Xn[ti++]=r>>8,Xn[ti++]=255&r):(Xn[ti++]=26,Gn.setUint32(ti,r),ti+=4);else if("object"===i)if(r){if(s){let t=s.get(r);if(t){if(Xn[ti++]=216,Xn[ti++]=29,Xn[ti++]=25,!t.references){let e=s.idsToInsert||(s.idsToInsert=[]);t.references=[],e.push(t)}return t.references.push(ti-e),void(ti+=2)}s.set(r,{offset:ti-e})}let t=r.constructor;if(t===Object)b(r);else if(t===Array){n=r.length,n<24?Xn[ti++]=128|n:hi(n);for(let t=0;t<n;t++)m(r[t])}else if(t===Map)if((this.mapsAsObjects?!1!==this.useTag259ForMaps:this.useTag259ForMaps)&&(Xn[ti++]=217,Xn[ti++]=1,Xn[ti++]=3),n=r.size,n<24?Xn[ti++]=160|n:n<256?(Xn[ti++]=184,Xn[ti++]=n):n<65536?(Xn[ti++]=185,Xn[ti++]=n>>8,Xn[ti++]=255&n):(Xn[ti++]=186,Gn.setUint32(ti,n),ti+=4),a.keyMap)for(let[e,n]of r)m(a.encodeKey(e)),m(n);else for(let[e,n]of r)m(e),m(n);else{for(let t=0,e=zn.length;t<e;t++){let e=Fn[t];if(r instanceof e){let e=zn[t],n=e.tag;return void 0==n&&(n=e.getTag&&e.getTag.call(this,r)),n<24?Xn[ti++]=192|n:n<256?(Xn[ti++]=216,Xn[ti++]=n):n<65536?(Xn[ti++]=217,Xn[ti++]=n>>8,Xn[ti++]=255&n):n>-1&&(Xn[ti++]=218,Gn.setUint32(ti,n),ti+=4),void e.encode.call(this,r,m,_)}}if(r[Symbol.iterator]){if(Qn){let t=new Error("Iterable should be serialized as iterator");throw t.iteratorNotHandled=!0,t}Xn[ti++]=159;for(let t of r)m(t);return void(Xn[ti++]=255)}if(r[Symbol.asyncIterator]||li(r)){let t=new Error("Iterable/blob should be serialized as iterator");throw t.iteratorNotHandled=!0,t}if(this.useToJSON&&r.toJSON){const t=r.toJSON();if(t!==r)return m(t)}b(r)}}else Xn[ti++]=246;else if("boolean"===i)Xn[ti++]=r?245:244;else if("bigint"===i){if(r<BigInt(1)<<BigInt(64)&&r>=0)Xn[ti++]=27,Gn.setBigUint64(ti,r);else if(r>-(BigInt(1)<<BigInt(64))&&r<0)Xn[ti++]=59,Gn.setBigUint64(ti,-r-BigInt(1));else{if(!this.largeBigIntToFloat){r>=BigInt(0)?Xn[ti++]=194:(Xn[ti++]=195,r=BigInt(-1)-r);let t=[];while(r)t.push(Number(r&BigInt(255))),r>>=BigInt(8);return void pi(new Uint8Array(t.reverse()),_)}Xn[ti++]=251,Gn.setFloat64(ti,Number(r))}ti+=8}else{if("undefined"!==i)throw new Error("Unknown type: "+i);Xn[ti++]=247}},b=!1===this.useRecords?this.variableMapSize?t=>{let e=Object.keys(t),r=Object.values(t),n=e.length;if(n<24?Xn[ti++]=160|n:n<256?(Xn[ti++]=184,Xn[ti++]=n):n<65536?(Xn[ti++]=185,Xn[ti++]=n>>8,Xn[ti++]=255&n):(Xn[ti++]=186,Gn.setUint32(ti,n),ti+=4),a.keyMap)for(let i=0;i<n;i++)m(a.encodeKey(e[i])),m(r[i]);else for(let i=0;i<n;i++)m(e[i]),m(r[i])}:t=>{Xn[ti++]=185;let r=ti-e;ti+=2;let n=0;if(a.keyMap)for(let e in t)("function"!==typeof t.hasOwnProperty||t.hasOwnProperty(e))&&(m(a.encodeKey(e)),m(t[e]),n++);else for(let e in t)("function"!==typeof t.hasOwnProperty||t.hasOwnProperty(e))&&(m(e),m(t[e]),n++);Xn[r+++e]=n>>8,Xn[r+e]=255&n}:(t,e)=>{let r,s,o,a=i.transitions||(i.transitions=Object.create(null)),h=0,l=0;if(this.keyMap){o=Object.keys(t).map((t=>this.encodeKey(t))),l=o.length;for(let t=0;t<l;t++){let e=o[t];r=a[e],r||(r=a[e]=Object.create(null),h++),a=r}}else for(let n in t)("function"!==typeof t.hasOwnProperty||t.hasOwnProperty(n))&&(r=a[n],r||(1048576&a[ii]&&(s=65535&a[ii]),r=a[n]=Object.create(null),h++),a=r,l++);let u=a[ii];if(void 0!==u)u&=65535,Xn[ti++]=217,Xn[ti++]=u>>8|224,Xn[ti++]=255&u;else{if(o||(o=a.__keys__||(a.__keys__=Object.keys(t))),void 0===s?(u=i.nextId++,u||(u=0,i.nextId=1),u>=Jn&&(i.nextId=(u=c)+1)):u=s,i[u]=o,!(u<c)){if(a[ii]=u,Gn.setUint32(ti,3655335680),ti+=3,h&&(y+=w*h),g.length>=Jn-c&&(g.shift()[ii]=void 0),g.push(a),hi(l+2),m(57344+u),m(o),e)return;for(let e in t)("function"!==typeof t.hasOwnProperty||t.hasOwnProperty(e))&&m(t[e]);return}Xn[ti++]=217,Xn[ti++]=u>>8|224,Xn[ti++]=255&u,a=i.transitions;for(let t=0;t<l;t++)(void 0===a[ii]||1048576&a[ii])&&(a[ii]=u),a=a[o[t]];a[ii]=1048576|u,n=!0}if(l<24?Xn[ti++]=128|l:hi(l),!e)for(let n in t)("function"!==typeof t.hasOwnProperty||t.hasOwnProperty(n))&&m(t[n])},_=t=>{let r;if(t>16777216){if(t-e>Wn)throw new Error("Encoded buffer would be larger than maximum buffer size");r=Math.min(Wn,4096*Math.round(Math.max((t-e)*(t>67108864?1.25:2),4194304)/4096))}else r=1+(Math.max(t-e<<2,Xn.length-1)>>12)<<12;let n=new Hn(r);return Gn=new DataView(n.buffer,0,r),Xn.copy?Xn.copy(n,0,e,t):n.set(Xn.slice(e,t)),ti-=e,e=0,Zn=n.length-10,Xn=n};let v=100,A=1e3;function*k(t,r,n){let i=t.constructor;if(i===Object){let e=!1!==a.useRecords;e?b(t,!0):oi(Object.keys(t).length,160);for(let n in t){let i=t[n];e||m(n),i&&"object"===typeof i?r[n]?yield*k(i,r[n]):yield*E(i,r,n):m(i)}}else if(i===Array){let n=t.length;hi(n);for(let i=0;i<n;i++){let n=t[i];n&&("object"===typeof n||ti-e>v)?r.element?yield*k(n,r.element):yield*E(n,r,"element"):m(n)}}else if(t[Symbol.iterator]&&!t.buffer){Xn[ti++]=159;for(let n of t)n&&("object"===typeof n||ti-e>v)?r.element?yield*k(n,r.element):yield*E(n,r,"element"):m(n);Xn[ti++]=255}else li(t)?(oi(t.size,64),yield Xn.subarray(e,ti),yield t,x()):t[Symbol.asyncIterator]?(Xn[ti++]=159,yield Xn.subarray(e,ti),yield t,x(),Xn[ti++]=255):m(t);n&&ti>e?yield Xn.subarray(e,ti):ti-e>v&&(yield Xn.subarray(e,ti),x())}function*E(t,r,n){let i=ti-e;try{m(t),ti-e>v&&(yield Xn.subarray(e,ti),x())}catch($i){if(!$i.iteratorNotHandled)throw $i;r[n]={},ti=e+i,yield*k.call(this,t,r[n])}}function x(){v=A,a.encode(null,xi)}function C(t,e,r){return v=e&&e.chunkThreshold?A=e.chunkThreshold:100,t&&"object"===typeof t?(a.encode(null,xi),r(t,a.iterateProperties||(a.iterateProperties={}),!0)):[a.encode(t)]}async function*S(t,e){for(let r of k(t,e,!0)){let t=r.constructor;if(t===Yn||t===Uint8Array)yield r;else if(li(r)){let t,e=r.stream().getReader();while(!(t=await e.read()).done)yield t.value}else if(r[Symbol.asyncIterator])for await(let n of r)x(),n?yield*S(n,e.async||(e.async={})):yield a.encode(n);else yield r}}this.encodeAsIterable=function(t,e){return C(t,e,k)},this.encodeAsAsyncIterable=function(t,e){return C(t,e,S)}}useBuffer(t){Xn=t,Gn=new DataView(Xn.buffer,Xn.byteOffset,Xn.byteLength),ti=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let t=this.sharedVersion||0;this.sharedVersion=t+1;let e=this.structures.slice(0),r=new ai(e,this.sharedValues,this.sharedVersion),n=this.saveShared(r,(e=>(e&&e.version||0)==t));return!1===n?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):e.forEach(((t,e)=>this.structures[e]=t)),n}}function oi(t,e){t<24?Xn[ti++]=e|t:t<256?(Xn[ti++]=24|e,Xn[ti++]=t):t<65536?(Xn[ti++]=25|e,Xn[ti++]=t>>8,Xn[ti++]=255&t):(Xn[ti++]=26|e,Gn.setUint32(ti,t),ti+=4)}class ai{constructor(t,e,r){this.structures=t,this.packedValues=e,this.version=r}}function hi(t){t<24?Xn[ti++]=128|t:t<256?(Xn[ti++]=152,Xn[ti++]=t):t<65536?(Xn[ti++]=153,Xn[ti++]=t>>8,Xn[ti++]=255&t):(Xn[ti++]=154,Gn.setUint32(ti,t),ti+=4)}const ci="undefined"===typeof Blob?function(){}:Blob;function li(t){if(t instanceof ci)return!0;let e=t[Symbol.toStringTag];return"Blob"===e||"File"===e}function ui(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)2==++r.count&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let r=e.samplingPackedValues.get(t);r?r.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,n=t.length;r<n;r++)ui(t[r],e);else{let n=!e.encoder.useRecords;for(var r in t)t.hasOwnProperty(r)&&(n&&ui(r,e),ui(t[r],e))}break;case"function":console.log(t)}}const di=1==new Uint8Array(new Uint16Array([1]).buffer)[0];function fi(t,e){return!di&&e>1&&(t-=4),{tag:t,encode:function(t,e){let r=t.byteLength,n=t.byteOffset||0,i=t.buffer||t;e(Kn?Vn.from(i,n,r):new Uint8Array(i,n,r))}}}function pi(t,e){let r=t.byteLength;r<24?Xn[ti++]=64+r:r<256?(Xn[ti++]=88,Xn[ti++]=r):r<65536?(Xn[ti++]=89,Xn[ti++]=r>>8,Xn[ti++]=255&r):(Xn[ti++]=90,Gn.setUint32(ti,r),ti+=4),ti+r>=Xn.length&&e(ti+r),Xn.set(t.buffer?t:new Uint8Array(t),ti),ti+=r}function gi(t,e){let r,n=2*e.length,i=t.length-n;e.sort(((t,e)=>t.offset>e.offset?1:-1));for(let s=0;s<e.length;s++){let r=e[s];r.id=s;for(let e of r.references)t[e++]=s>>8,t[e]=255&s}while(r=e.pop()){let e=r.offset;t.copyWithin(e+n,e,i),n-=2;let s=e+n;t[s++]=216,t[s++]=28,i=e}return t}function yi(t,e){Gn.setUint32(ei.position+t,ti-ei.position-t+1);let r=ei;ei=null,e(r[0]),e(r[1])}Fn=[Date,Set,Error,RegExp,vn,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,"undefined"==typeof BigUint64Array?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,"undefined"==typeof BigInt64Array?function(){}:BigInt64Array,Float32Array,Float64Array,ai],zn=[{tag:1,encode(t,e){let r=t.getTime()/1e3;(this.useTimestamp32||0===t.getMilliseconds())&&r>=0&&r<4294967296?(Xn[ti++]=26,Gn.setUint32(ti,r),ti+=4):(Xn[ti++]=251,Gn.setFloat64(ti,r),ti+=8)}},{tag:258,encode(t,e){let r=Array.from(t);e(r)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,r){pi(t,r)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||Kn&&!1!==this.tagUint8Array))return 64},encode(t,e,r){pi(t,r)}},fi(68,1),fi(69,2),fi(70,4),fi(71,8),fi(72,1),fi(77,2),fi(78,4),fi(79,8),fi(85,4),fi(86,8),{encode(t,e){let r=t.packedValues||[],n=t.structures||[];if(r.values.length>0){Xn[ti++]=216,Xn[ti++]=51,hi(4);let t=r.values;e(t),hi(0),hi(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let e=0,r=t.length;e<r;e++)packedObjectMap[t[e]]=e}if(n){Gn.setUint32(ti,3655335424),ti+=3;let r=n.slice(0);r.unshift(57344),r.push(new vn(t.version,1399353956)),e(r)}else e(new vn(t.version,1399353956))}}];let wi=new si({useRecords:!1});const mi=wi.encode,{NEVER:bi,ALWAYS:_i,DECIMAL_ROUND:vi,DECIMAL_FIT:Ai}=(wi.encodeAsIterable,wi.encodeAsAsyncIterable,$n),ki=512,Ei=1024,xi=2048;class Ci{id;reference;params;constructor(t,e){this.id=t,this.reference=e}}class Si{request;constructor(t,e){this.request=new Ci(t,e)}addParams(t){return this.request.params=t,this}get(){return this.request}}class Oi{providerId;txns}class Mi{params;constructor(){this.params=new Oi}addProviderId(t){return this.params.providerId=t,this}addTxns(t){return this.params.txns=t,this}get(){return this.params}}const Ri=255e3,Bi=`Message too large, maximum is ${Ri} in length`,Ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",qi="Invalid base64url input";function Ii(t){const e=t instanceof Uint8Array?t:new Uint8Array(t),r=e.length;let n="";for(let i=0;i<r;i+=3)n+=Ti[e[i]>>2],n+=Ti[(3&e[i])<<4|e[i+1]>>4],n+=Ti[(15&e[i+1])<<2|e[i+2]>>6],n+=Ti[63&e[i+2]];return r%3===2?n=n.substring(0,n.length-1):r%3===1&&(n=n.substring(0,n.length-2)),n}function Pi(t){if("string"!==typeof t)throw new Error(qi);return new Uint8Array(atob(t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")).split("").map((t=>t.charCodeAt(0))))}function Di(t,e,r){const n=(new Mi).addProviderId(e).addTxns(r).get(),i=new Si(t,"arc0027:sign_transactions:request").addParams(n).get(),s=mi(i);if(s.length>Ri)throw new Error(Bi);return Ii(s)}var Ni=r(64588);class Li{client;options;RTC_CONFIGURATION;dataChannel;linkedBool=!1;modalElement;requestId;altRequestId;eventListeners=[];constructor(t){this.options=t,this.client=new Or(window.origin),this.RTC_CONFIGURATION={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]},{urls:["turn:global.turn.nodely.network:80?transport=tcp","turns:global.turn.nodely.network:443?transport=tcp","turn:eu.turn.nodely.io:80?transport=tcp","turns:eu.turn.nodely.io:443?transport=tcp","turn:us.turn.nodely.io:80?transport=tcp","turns:us.turn.nodely.io:443?transport=tcp"],username:this.options.RTC_config_username,credential:this.options.RTC_config_credential},{urls:["turn:global.relay.metered.ca:80","turn:global.relay.metered.ca:80?transport=tcp","turn:global.relay.metered.ca:443","turns:global.relay.metered.ca:443?transport=tcp"],username:this.options.RTC_config_username,credential:this.options.RTC_config_credential}],iceCandidatePoolSize:10}}async connect(){const t=Or.generateRequestId(),e=t;this.showModal(t,e),await this.waitForLinkedBool()}async disconnect(){this.linkedBool=!1,this.client.close();const t=await this.logOutSession();if(this.cleanUp(),!t)throw new Error("Failed to disconnect")}setDataChannel(t){this.dataChannel=t}async onLinkMessage(t){if(t.wallet){const e=await this.checkSession();if(e?.user?.wallet===t.wallet)return console.log("Session data:",e),console.log("Wallet linked:",t.wallet),void(this.linkedBool=!0);throw new Error("Remote wallet address and /auth/session wallet address do not match")}throw new Error("Wallet field not part of link message")}async checkSession(){try{const t=await fetch(`${window.origin}/auth/session`,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){const e=await t.json();return console.log("Session data:",e),e}return console.log("No session found"),null}catch($i){return console.error("Error querying session:",$i),null}}async logOutSession(){try{const t=await fetch(`${window.origin}/auth/logout`,{method:"GET",headers:{"Content-Type":"application/json"}});if(302===t.status||200===t.status){const t=await this.checkSession();return null===t?.user?(console.log("Successfully logged."),!0):(console.error("Logout failed: User is still logged in."),!1)}return console.log("Failed to log out, received code: ",t.status),!1}catch($i){return console.error("Error logging out:",$i),!1}}async signTransactions(t,e,r){const n=Or.generateRequestId(),i="02657eaf-be17-4efc-b0a4-19d654b2448e";if(!this.dataChannel)throw new Error("Data channel not set yet!");const s=()=>new Promise(((r,i)=>{this.dataChannel&&(this.dataChannel.onmessage=async s=>{const o=Un(Pi(s.data));if("arc0027:sign_transactions:response"===o.reference){if(o.requestId!==n)return void i(new Error("Request ID mismatch"));const s=o.result.stxns,a=t.map(((t,r)=>t.attachSignature(e,Pi(s[r]))));r(a)}})})),o=Di(n,i,t.map((t=>({txn:Ii((0,Ni.encodeUnsignedTransaction)(t))}))));return console.log("Sending message:",o),this.dataChannel.send(o),await s()}showModal(t,e){if(this.requestId=t,this.altRequestId=e,!this.modalElement){this.modalElement=document.createElement("div"),this.modalElement.classList.add("liquid-auth-modal","hidden"),this.modalElement.innerHTML=`\n          <div class="modal-content">\n            <button class="close-button">x</button>\n            <div class="call-session">\n              <div class="offer">\n                <a id="qr-link" href="https://github.com/algorandfoundation/liquid-auth-js" target="_blank">\n                  <img id="liquid-qr-code" src="" class="logo hidden" alt="Liquid QR Code" />\n                </a>\n                <hgroup>\n                  <h1>Offer Client</h1>\n                  <h2>Local ID: ${this.requestId}</h2>\n                </hgroup> \n                <button id="start">Start</button>\n              </div>\n            </div>\n          </div>\n        `;const t=document.createElement("style");t.textContent="\n          .hidden {\n            display: none;\n          }\n          .liquid-auth-modal {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.5);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n          }\n          .modal-content {\n            background: white;\n            padding: 20px;\n            border-radius: 8px;\n            position: relative;\n            max-width: 500px;\n            width: 100%;\n            color: black;\n          }\n          .close-button {\n            position: absolute;\n            top: 10px;\n            right: 10px;\n            background: none;\n            border: none;\n            font-size: 20px;\n            cursor: pointer;\n            color: black;\n          }\n          #liquid-qr-code {\n          width: 300px;\n          height: 300px;\n        }\n        ",this.modalElement.appendChild(t),document.body.appendChild(this.modalElement);const e=this.modalElement.querySelector(".close-button"),r=()=>{this.hideModal(),this.cleanUp()};e.addEventListener("click",r),this.eventListeners.push({element:e,type:"click",listener:r});const n=this.modalElement.querySelector("#start"),i=()=>this.handleOfferClient();n.addEventListener("click",i),this.eventListeners.push({element:n,type:"click",listener:i})}this.modalElement.querySelector("h2").textContent=`Local ID: ${this.requestId}`,this.modalElement.classList.remove("hidden")}hideModal(){this.modalElement&&(this.modalElement.classList.add("hidden"),this.modalElement.style.display="none")}handleDataChannel=t=>{t.onmessage=t=>{console.log("Received message:",t.data)},this.setDataChannel(t)};async handleOfferClient(){const t=this.modalElement.querySelector("#qr-link");if(t){t.href="https://github.com/algorandfoundation/liquid-auth-js",this.client.peer(this.requestId,"offer",this.RTC_CONFIGURATION).then(this.handleDataChannel),this.client.on("link-message",(t=>{this.onLinkMessage(t);const e=this.modalElement.querySelector(".offer");e&&e.classList.add("hidden")}));const e=this.modalElement.querySelector("#liquid-qr-code");e&&(e.src=await this.client.qrCode(),e.classList.remove("hidden"));const r=this.modalElement.querySelector("#qr-link");r&&(r.href=this.client.deepLink(this.requestId));const n=this.modalElement.querySelector("#start");n&&n.classList.add("hidden")}else console.error("QR link element not found")}cleanUp(){this.eventListeners.forEach((({element:t,type:e,listener:r})=>{t.removeEventListener(e,r)})),this.eventListeners=[],this.modalElement&&(document.body.removeChild(this.modalElement),this.modalElement=null)}async waitForLinkedBool(){return new Promise((t=>{const e=()=>{this.linkedBool?t():setTimeout(e,100)};e()}))}}}}]);
//# sourceMappingURL=613.7e02554b.js.map